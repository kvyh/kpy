<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. SEDMr package &mdash; SEDM Pipeline 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="SEDM Pipeline 0.1 documentation" href="index.html" />
    <link rel="next" title="4. SEDMrph package" href="SEDMrph.html" />
    <link rel="prev" title="2. SEDM package" href="SEDM.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sedmr-package">
<h1>3. SEDMr package<a class="headerlink" href="#sedmr-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-SEDMr.AtmCorr">
<span id="sedmr-atmcorr-module"></span><h2>3.1. SEDMr.AtmCorr module<a class="headerlink" href="#module-SEDMr.AtmCorr" title="Permalink to this headline">¶</a></h2>
<p>Process standard star corrections</p>
<blockquote>
<div><dl class="docutils">
<dt>The three options for processing are:</dt>
<dd><ul class="first last simple">
<li>CORR    - extract a single correction vector</li>
<li>SUM     - obsolete version of CREATE</li>
<li>CREATE  - create an ensemble correction</li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>Functions:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="#SEDMr.AtmCorr.handle_corr" title="SEDMr.AtmCorr.handle_corr"><code class="xref py py-func docutils literal"><span class="pre">handle_corr()</span></code></a> output a single correction</li>
<li><a class="reference internal" href="#SEDMr.AtmCorr.handle_create" title="SEDMr.AtmCorr.handle_create"><code class="xref py py-func docutils literal"><span class="pre">handle_create()</span></code></a> create a calibration spectrum</li>
<li><a class="reference internal" href="#SEDMr.AtmCorr.handle_summary" title="SEDMr.AtmCorr.handle_summary"><code class="xref py py-func docutils literal"><span class="pre">handle_summary()</span></code></a> obsolete version of handle_create</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is used as a python script as follows:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">AtmCorr</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">A</span> <span class="n">A</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">outname</span> <span class="n">OUTNAME</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">std</span> <span class="n">STD</span><span class="p">]</span>
          <span class="p">[</span><span class="o">--</span><span class="n">files</span> <span class="n">file</span> <span class="p">[</span><span class="n">file</span> <span class="o">...</span><span class="p">]]</span>
          <span class="n">process</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">process</span>               <span class="n">Process</span> <span class="p">[</span><span class="n">CORR</span><span class="o">|</span><span class="n">SUM</span><span class="o">|</span><span class="n">CREATE</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">A</span> <span class="n">A</span>                 <span class="n">FITS</span> <span class="n">file</span> <span class="n">to</span> <span class="n">correct</span>
  <span class="o">--</span><span class="n">outname</span> <span class="n">OUTNAME</span>     <span class="n">Prefix</span> <span class="n">output</span> <span class="n">name</span>
  <span class="o">--</span><span class="n">std</span> <span class="n">STD</span>             <span class="n">Name</span> <span class="n">of</span> <span class="n">standard</span>
  <span class="o">--</span><span class="n">files</span> <span class="n">file</span> <span class="p">[</span><span class="n">file</span> <span class="o">...</span><span class="p">]</span>
                        <span class="nb">list</span> <span class="n">of</span> <span class="n">spectrum</span> <span class="n">files</span><span class="p">:</span> <span class="n">sp_STD</span><span class="o">-*.</span><span class="n">npy</span>
</pre></div>
</div>
</div>
<dl class="function">
<dt id="SEDMr.AtmCorr.handle_corr">
<code class="descclassname">SEDMr.AtmCorr.</code><code class="descname">handle_corr</code><span class="sig-paren">(</span><em>filename</em>, <em>outname='corrected.npy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/AtmCorr.html#handle_corr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.AtmCorr.handle_corr" title="Permalink to this definition">¶</a></dt>
<dd><p>Output single correction.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.AtmCorr.handle_create">
<code class="descclassname">SEDMr.AtmCorr.</code><code class="descname">handle_create</code><span class="sig-paren">(</span><em>outname=None</em>, <em>filelist=[]</em>, <em>plot_filt=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/AtmCorr.html#handle_create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.AtmCorr.handle_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create standard star correction. Units are erg/s/cm2/Ang</p>
<p>Read in the std-correction vector for each standard star, massage
the correction (see below) and output an ensemble correction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>outname</strong> (<em>str</em>) &#8211; name for resulting correction array (def: atm-corr.npy)</li>
<li><strong>filelist</strong> (<em>list</em>) &#8211; list of standard star extractions (e.g. sp_STD-*.npy)</li>
<li><strong>plot_filt</strong> (<em>bool</em>) &#8211; set to plot intermediate filtered steps (def: False)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>A dictionary containing the ensemble correction and some
details:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>   <span class="s2">&quot;nm&quot;</span><span class="p">:</span> <span class="n">wavelengths</span> <span class="p">(</span><span class="n">nm</span><span class="p">),</span>
    <span class="s2">&quot;maxnm&quot;</span><span class="p">:</span> <span class="n">maximum</span> <span class="n">wavelength</span><span class="p">,</span>
    <span class="s2">&quot;correction&quot;</span><span class="p">:</span> <span class="n">the</span> <span class="n">correction</span> <span class="n">spectrum</span><span class="p">,</span>
    <span class="s2">&quot;doc&quot;</span><span class="p">:</span> <span class="s2">&quot;Correct ph/10 m/nm to erg/s/cm2/ang&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Nspec&quot;</span><span class="p">:</span> <span class="n">number</span> <span class="n">of</span> <span class="n">spectra</span> <span class="n">used</span><span class="p">,</span>
    <span class="s2">&quot;correction_std&quot;</span><span class="p">:</span> <span class="n">STDev</span> <span class="n">of</span> <span class="n">ensemble</span> <span class="n">corrections</span><span class="p">,</span>
    <span class="s2">&quot;outname&quot;</span><span class="p">:</span> <span class="n">outname</span> <span class="p">(</span><span class="n">see</span> <span class="n">Parameters</span><span class="p">),</span>
    <span class="s2">&quot;files&quot;</span><span class="p">:</span> <span class="n">filelist</span> <span class="p">(</span><span class="n">see</span> <span class="n">Parameters</span><span class="p">),</span>
    <span class="s2">&quot;when&quot;</span><span class="p">:</span> <span class="n">timestamp</span> <span class="n">string</span><span class="p">,</span>
    <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">user</span> <span class="n">who</span> <span class="n">ran</span> <span class="n">the</span> <span class="n">process</span>    <span class="p">}</span>
</pre></div>
</div>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Writes a *.npy file with the resulting correction</p>
</div>
</dd></dl>

<dl class="function">
<dt id="SEDMr.AtmCorr.handle_summary">
<code class="descclassname">SEDMr.AtmCorr.</code><code class="descname">handle_summary</code><span class="sig-paren">(</span><em>outname=None</em>, <em>filelist=[]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/AtmCorr.html#handle_summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.AtmCorr.handle_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract all std-correction vectors and create ensemble (obsolete)</p>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.Check">
<span id="sedmr-check-module"></span><h2>3.2. SEDMr.Check module<a class="headerlink" href="#module-SEDMr.Check" title="Permalink to this headline">¶</a></h2>
<p>Graphical check of either a spectrum or a cube.</p>
<p>Generate matplotlib plots for visual confirmation of
extractions, or generate PDF files of the extractions.
Also can produce an ascii spectrum suitable for upload
or input to transient classification programs.</p>
<dl class="docutils">
<dt>Functions</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="#SEDMr.Check.checkCube" title="SEDMr.Check.checkCube"><code class="xref py py-func docutils literal"><span class="pre">checkCube()</span></code></a>   Plot a cube</li>
<li><a class="reference internal" href="#SEDMr.Check.checkSpec" title="SEDMr.Check.checkSpec"><code class="xref py py-func docutils literal"><span class="pre">checkSpec()</span></code></a>   Plot a spectrum</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is used as a python script as follows:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">Check</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">cube</span> <span class="n">CUBE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">lambdarms</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">savefig</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">savespec</span><span class="p">]</span>
        <span class="p">[</span><span class="o">--</span><span class="n">spec</span> <span class="n">SPEC</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">corrname</span> <span class="n">CORRNAME</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">redshift</span> <span class="n">REDSHIFT</span><span class="p">]</span>
        <span class="p">[</span><span class="o">--</span><span class="n">smoothing</span> <span class="n">SMOOTHING</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">cube</span> <span class="n">CUBE</span>           <span class="n">Fine</span> <span class="n">correction</span> <span class="n">path</span>
  <span class="o">--</span><span class="n">lambdarms</span>           <span class="n">Show</span> <span class="k">lambda</span> <span class="n">soln</span> <span class="n">rms</span>
  <span class="o">--</span><span class="n">savefig</span>             <span class="n">Save</span> <span class="n">pdf</span> <span class="n">figure</span>
  <span class="o">--</span><span class="n">savespec</span>            <span class="n">Save</span> <span class="n">spec</span> <span class="n">ASCII</span> <span class="n">file</span>
  <span class="o">--</span><span class="n">spec</span> <span class="n">SPEC</span>           <span class="n">Extracted</span> <span class="n">spectrum</span> <span class="n">file</span>
  <span class="o">--</span><span class="n">corrname</span> <span class="n">CORRNAME</span>
  <span class="o">--</span><span class="n">redshift</span> <span class="n">REDSHIFT</span>   <span class="n">Redshift</span>
  <span class="o">--</span><span class="n">smoothing</span> <span class="n">SMOOTHING</span>
                        <span class="n">Smoothing</span> <span class="ow">in</span> <span class="n">pixels</span>
</pre></div>
</div>
</div>
<dl class="function">
<dt id="SEDMr.Check.checkCube">
<code class="descclassname">SEDMr.Check.</code><code class="descname">checkCube</code><span class="sig-paren">(</span><em>cubename</em>, <em>showlamrms=False</em>, <em>savefig=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Check.html#checkCube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Check.checkCube" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a datacube.</p>
<p>This function can produce a PDF file of the data cube.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cubename</strong> (<em>str</em>) &#8211; name of cube numpy file</li>
<li><strong>showlamrms</strong> (<em>bool</em>) &#8211; display the rms of the wavelength fit,
otherwise display average trace width</li>
<li><strong>savefig</strong> (<em>bool</em>) &#8211; save a pdf of the plot</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Check.checkSpec">
<code class="descclassname">SEDMr.Check.</code><code class="descname">checkSpec</code><span class="sig-paren">(</span><em>specname</em>, <em>corrname='std-correction.npy'</em>, <em>redshift=0</em>, <em>smoothing=0</em>, <em>savefig=False</em>, <em>savespec=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Check.html#checkSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Check.checkSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot a spectrum.</p>
<p>This function can produce an ascii spectrum suitable for uploading
to the iPTF marshal and including header lines that describe the
spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>specname</strong> (<em>str</em>) &#8211; name of spectrum numpy file, typically prefixed with &#8220;<a href="#id1"><span class="problematic" id="id2">sp_</span></a>&#8220;</li>
<li><strong>corrname</strong> (<em>str</em>) &#8211; name of the calibration correction numpy file</li>
<li><strong>redshift</strong> (<em>float</em>) &#8211; readshift for wavelength scale</li>
<li><strong>smoothing</strong> (<em>int</em>) &#8211; number of pixels to smooth over</li>
<li><strong>savefig</strong> (<em>bool</em>) &#8211; save a pdf of the plot</li>
<li><strong>savespec</strong> (<em>bool</em>) &#8211; save an ascii spectrum</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.CosmicX">
<span id="sedmr-cosmicx-module"></span><h2>3.3. SEDMr.CosmicX module<a class="headerlink" href="#module-SEDMr.CosmicX" title="Permalink to this headline">¶</a></h2>
<span class="target" id="module-CosmicX"></span><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">synopsis:</th><td class="field-body">Remove cosmic rays from an astronomical image.</td>
</tr>
</tbody>
</table>
<p>kludged from PyCosmic to run _lacosmicx instead, which is faster</p>
</div>
<div class="section" id="module-SEDMr.Cube">
<span id="sedmr-cube-module"></span><h2>3.4. SEDMr.Cube module<a class="headerlink" href="#module-SEDMr.Cube" title="Permalink to this headline">¶</a></h2>
<p>Convert an extracted file into a data cube.</p>
<blockquote>
<div><dl class="docutils">
<dt>STEP is either:</dt>
<dd><ul class="first last simple">
<li>make: To create the data cube (once per night)</li>
<li>extract: To extract the cube (one for each observation)</li>
</ul>
</dd>
</dl>
</div></blockquote>
<dl class="docutils">
<dt>Functions:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="#SEDMr.Cube.QR_to_img" title="SEDMr.Cube.QR_to_img"><code class="xref py py-func docutils literal"><span class="pre">QR_to_img()</span></code></a> convert cube to an image</li>
<li><a class="reference internal" href="#SEDMr.Cube.extraction_to_cube" title="SEDMr.Cube.extraction_to_cube"><code class="xref py py-func docutils literal"><span class="pre">extraction_to_cube()</span></code></a> calculates sky positions</li>
<li><a class="reference internal" href="#SEDMr.Cube.reject_outliers" title="SEDMr.Cube.reject_outliers"><code class="xref py py-func docutils literal"><span class="pre">reject_outliers()</span></code></a> trims data values of outliers</li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>See figures here: <a class="reference external" href="http://www.astro.caltech.edu/sedm/_images/HexCoords.png">http://www.astro.caltech.edu/sedm/_images/HexCoords.png</a></p>
<p>Axial coordinates of a cube:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="p">(</span><span class="n">q</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>   <span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>   <span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>   <span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
    <span class="p">(</span><span class="n">q</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>   <span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Even Q coordinates look like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>    <span class="mi">0</span><span class="p">,</span><span class="mi">0</span>     <span class="mi">1</span><span class="p">,</span><span class="mi">0</span>     <span class="mi">2</span><span class="p">,</span><span class="mi">0</span>     <span class="mi">3</span><span class="p">,</span><span class="mi">0</span>
<span class="mi">0</span><span class="p">,</span><span class="mi">1</span>     <span class="mi">1</span><span class="p">,</span><span class="mi">1</span>     <span class="mi">2</span><span class="p">,</span><span class="mi">1</span>     <span class="mi">3</span><span class="p">,</span><span class="mi">1</span>     <span class="mi">4</span><span class="p">,</span><span class="mi">1</span>
    <span class="mi">0</span><span class="p">,</span><span class="mi">2</span>     <span class="mi">1</span><span class="p">,</span><span class="mi">2</span>     <span class="mi">2</span><span class="p">,</span><span class="mi">2</span>     <span class="mi">3</span><span class="p">,</span><span class="mi">2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is used as a python script as follows:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">Cube</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">step</span> <span class="n">STEP</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">outname</span> <span class="n">OUTNAME</span><span class="p">]</span> <span class="n">extracted</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">extracted</span>          <span class="n">Extracted</span> <span class="n">file</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>         <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">step</span> <span class="n">STEP</span>        <span class="p">[</span><span class="n">make</span><span class="o">|</span><span class="n">extract</span><span class="o">|</span><span class="n">dump</span><span class="p">]</span>
  <span class="o">--</span><span class="n">outname</span> <span class="n">OUTNAME</span>  <span class="n">Output</span> <span class="n">cube</span> <span class="n">name</span>
</pre></div>
</div>
</div>
<dl class="function">
<dt id="SEDMr.Cube.QR_to_img">
<code class="descclassname">SEDMr.Cube.</code><code class="descname">QR_to_img</code><span class="sig-paren">(</span><em>exts</em>, <em>Size=4</em>, <em>outname='cube.fits'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Cube.html#QR_to_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Cube.QR_to_img" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a data cube to a fits image</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>exts</strong> (<em>list of Extraction</em>) &#8211; extractions to convert (see Extraction.py)</li>
<li><strong>Size</strong> (<em>int</em>) &#8211; expansion factor, defaults to 4</li>
<li><strong>outname</strong> (<em>str</em>) &#8211; output fits file name, defaults to cube.fits</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Cube.extraction_to_cube">
<code class="descclassname">SEDMr.Cube.</code><code class="descname">extraction_to_cube</code><span class="sig-paren">(</span><em>exts</em>, <em>outname='G.npy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Cube.html#extraction_to_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Cube.extraction_to_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the extraction to sky coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>exts</strong> (<em>list of Extraction</em>) &#8211; The list of extractions (see Extraction.py)</li>
<li><strong>outname</strong> (<em>str</em>) &#8211; The file created with the new extraction</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The new data cube has the following coordinate positions populated:</p>
<ul class="simple">
<li>X_as: X position in arcsec</li>
<li>Y_as: Y position in arcsec</li>
<li>Z_as: Z position in arcsec (the Z coordinate runs 45 degrees to X and is not a <cite>3rd</cite> dimension).</li>
<li>Q_ix: The axial Q coordinate in integral units</li>
<li>R_ix: The axial R coordinate in integral units</li>
</ul>
<p>The relationship of Q/R to X/Y is defined through the pixel mapping
matrix times the rotation matrix:</p>
<ul class="last simple">
<li>P2H = np.array([[np.sqrt(3)/3, -1/3.], [0, 2/3.]])</li>
<li>Rot (22 degree)</li>
</ul>
</div>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Cube.reject_outliers">
<code class="descclassname">SEDMr.Cube.</code><code class="descname">reject_outliers</code><span class="sig-paren">(</span><em>data</em>, <em>m=2.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Cube.html#reject_outliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Cube.reject_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Reject outliers beyond <cite>m</cite> sigma</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>numpy float array</em>) &#8211; data values</li>
<li><strong>m</strong> (<em>float</em>) &#8211; sigma factor for rejections threshhold</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">input array with outliers removed</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(numpy float array)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.Debias">
<span id="sedmr-debias-module"></span><h2>3.5. SEDMr.Debias module<a class="headerlink" href="#module-SEDMr.Debias" title="Permalink to this headline">¶</a></h2>
<p>Bias, Overscan subtraction and Gain correction functions</p>
<dl class="docutils">
<dt>Functions:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="#SEDMr.Debias.add_prefix" title="SEDMr.Debias.add_prefix"><code class="xref py py-func docutils literal"><span class="pre">add_prefix()</span></code></a> adds bias &#8220;<a href="#id3"><span class="problematic" id="id4">b_</span></a>&#8221; prefix to input name</li>
<li><a class="reference internal" href="#SEDMr.Debias.full_frame" title="SEDMr.Debias.full_frame"><code class="xref py py-func docutils literal"><span class="pre">full_frame()</span></code></a> calculates smoothed overscan vector</li>
<li><a class="reference internal" href="#SEDMr.Debias.remove" title="SEDMr.Debias.remove"><code class="xref py py-func docutils literal"><span class="pre">remove()</span></code></a> subtracts overscan and converts to electrons</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is used as a python script as follows:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">Debias</span><span class="o">.</span><span class="n">py</span> <span class="n">file</span> <span class="p">[</span><span class="n">file</span> <span class="o">...</span><span class="p">]]</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
 <span class="n">file</span>           <span class="n">An</span> <span class="n">image</span> <span class="n">file</span> <span class="n">to</span> <span class="n">be</span> <span class="n">processed</span>
</pre></div>
</div>
</div>
<dl class="function">
<dt id="SEDMr.Debias.add_prefix">
<code class="descclassname">SEDMr.Debias.</code><code class="descname">add_prefix</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Debias.html#add_prefix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Debias.add_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds bias prefix to input name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fname</strong> (<em>str</em>) &#8211; file to be de-biased</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">input filename with &#8220;<a href="#id5"><span class="problematic" id="id6">b_</span></a>&#8221; prepended</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Debias.full_frame">
<code class="descclassname">SEDMr.Debias.</code><code class="descname">full_frame</code><span class="sig-paren">(</span><em>dat</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Debias.html#full_frame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Debias.full_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate smoothed overscan vector</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dat</strong> (<em>numpy array</em>) &#8211; image frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">median smoothed overscan vector</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy vector</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Debias.remove">
<code class="descclassname">SEDMr.Debias.</code><code class="descname">remove</code><span class="sig-paren">(</span><em>fits_obj</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Debias.html#remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Debias.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the overscan-subtracted and gain-corrected version of the fits object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fits_obj</strong> (<em>fits object</em>) &#8211; fits science image to be overscan-subtracted</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">bias-subtracted and gain corrected image</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">data array</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.DivideFlat">
<span id="sedmr-divideflat-module"></span><h2>3.6. SEDMr.DivideFlat module<a class="headerlink" href="#module-SEDMr.DivideFlat" title="Permalink to this headline">¶</a></h2>
<p>Divide a science frame by the flat frame with flexure</p>
<p>This routine may be obsolete and is currently unused by the pipeline.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is used as a python script as follows:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">DivideFlat</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">flexnpy</span> <span class="n">FLEXNPY</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">outfile</span> <span class="n">OUTFILE</span><span class="p">]</span>
             <span class="n">flatfits</span> <span class="n">toflattenfits</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">flatfits</span>           <span class="n">Flat</span> <span class="n">field</span> <span class="n">fits</span> <span class="n">file</span>
  <span class="n">toflattenfits</span>      <span class="n">To</span> <span class="n">flatten</span> <span class="n">fits</span> <span class="n">file</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>         <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">flexnpy</span> <span class="n">FLEXNPY</span>  <span class="n">Flexure</span> <span class="o">.</span><span class="n">npy</span> <span class="n">file</span>
  <span class="o">--</span><span class="n">outfile</span> <span class="n">OUTFILE</span>  <span class="n">Output</span> <span class="n">filename</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-SEDMr.Extraction">
<span id="sedmr-extraction-module"></span><h2>3.7. SEDMr.Extraction module<a class="headerlink" href="#module-SEDMr.Extraction" title="Permalink to this headline">¶</a></h2>
<p>SED Machine Extraction class
(c) 2014 Nick Konidaris</p>
<p>This class is an abstract wrapper around the extraction</p>
<dl class="class">
<dt id="SEDMr.Extraction.Extraction">
<em class="property">class </em><code class="descclassname">SEDMr.Extraction.</code><code class="descname">Extraction</code><span class="sig-paren">(</span><em>seg_id=None</em>, <em>ok=None</em>, <em>xrange=None</em>, <em>yrange=None</em>, <em>poly=None</em>, <em>spec=None</em>, <em>specw=None</em>, <em>specf=None</em>, <em>specwf=None</em>, <em>exptime=None</em>, <em>trace_sigma=None</em>, <em>hg_lines=None</em>, <em>X_as=None</em>, <em>Y_as=None</em>, <em>Q_ix=None</em>, <em>R_ix=None</em>, <em>X_pix=None</em>, <em>Y_pix=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extraction.html#Extraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extraction.Extraction" title="Permalink to this definition">¶</a></dt>
<dd><p>SED machine spectral extraction class.</p>
<p>Generally there are several thousand such Extractions that are held for
a single 2k x 2k frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>seg_id</strong> (<em>int</em>) &#8211; Number from 1 to the maximum segment number. The segment
number is generated by sextractor.</li>
<li><strong>ok</strong> (<em>bool</em>) &#8211; Flag indicating the success of wavelength solutions</li>
<li><strong>xrange</strong> (<em>[int,int]</em>) &#8211; From sextractor, the beginning and end of the segment.
Usually ~ 250 pixels long.</li>
<li><strong>yrange</strong> (<em>[int,int]</em>) &#8211; From sextractor, the top and bottom of the segment.
Usually less than ~4 pixels.</li>
<li><strong>poly</strong> (<em>[float]</em>) &#8211; Coefficients to the polynomial function tracing the
ridge of each spectrum. Is converted to a polynomial function via
np.poly1d. The function parameter is a pixel integer starting
from xrange[0]</li>
<li><strong>trace_sigma</strong> (<em>float</em>) &#8211; The width of the trace that would be used for &#8220;optimal&#8221;
type extractions. The value of trace_sigma represents one standard
deviation. Unit is pixel.</li>
<li><strong>profile_sd</strong> (<em>float</em>) &#8211; Profile standard deviation of extraction along ridgeline</li>
<li><strong>spec</strong> (<em>[float]</em>) &#8211; The extracted 1d spectrum.</li>
<li><strong>specw</strong> (<em>[float]</em>) &#8211; The extracted 1d spectrum extracted using the profile trace.</li>
<li><strong>specf</strong> (<em>[float]</em>) &#8211; The extracted 1d spectrum extracted using fractional pixels. (SHOULD BE DEFAULT).</li>
<li><strong>specwf</strong> (<em>[float]</em>) &#8211; The extracted 1d spectrum extracted using fracitonal pixels with weighting</li>
<li><strong>({wavelength</strong> (<a class="reference internal" href="#SEDMr.Extraction.Extraction.hg_lines" title="SEDMr.Extraction.Extraction.hg_lines"><em>hg_lines</em></a>) &#8211; pixel}): An association of mercury lamp wavelength
and pixel position. These values come from sextractor</li>
<li><strong>hgcoef</strong> (<em>[float]</em>) &#8211; Chebyshev polynomial coefficients to the best-fit
mercury lamp spectrum. Used as an intermediate step. Do not use
in general.</li>
<li><strong>mdn_coeff</strong> (<em>[float]</em>) &#8211; Chebyshev polynomial coefficients to the best-fit
mercury and xe lamp spectrum. lamcoeff should be used as the
wavelength solution. Defaults to None.</li>
<li><strong>lamcoeff</strong> (<em>[float]</em>) &#8211; Chebyshev polynomial coefficients to the best-fit
mercury and xe lamp spectrum. lamcoeff should be used as the
wavelength solution. Defaults to None.</li>
<li><strong>lamrms</strong> (<em>float</em>) &#8211; The RMS residual (nm) for the best wavelength solution.</li>
<li><strong>lamnrms</strong> (<em>float</em>) &#8211; The RMS residual (normalized) for the best wavelength solution.</li>
<li><strong>X_as</strong> (<em>float</em>) &#8211; The relative position of the spaxel in arcsec</li>
<li><strong>Y_as</strong> (<em>float</em>) &#8211; The relative position of the spaxel in arcsec</li>
<li><strong>Q_ix</strong> (<em>int</em>) &#8211; Q coordinate of the pixel in axial units</li>
<li><strong>R_iq</strong> (<em>int</em>) &#8211; R coordinate of the pixel in axial units</li>
<li><strong>X_pix</strong> (<em>float</em>) &#8211; The absolute CCD position of the spaxel in pixel. X location is the estimated position of Halpha on the detector.</li>
<li><strong>Y_pix</strong> (<em>float</em>) &#8211; The absolute CCD position of the spaxel in pixel. Y location is based on the segmentation map.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>You should use the values as follows:</p>
<p>extractions = np.load(...)</p>
<p>extraction = extractions[500] # 500 is arbitrary for this example
pixel = 30
X = extraction.xrange[0] + pixel
wavelength = chebval(pixel, extraction.lamcoeff)</p>
<p>print &#8220;The spectrum starting at %i and pixel %i is %f&#8221; %             (extraction.xrange[0], pixel, wavelength)</p>
<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.Q_ix">
<code class="descname">Q_ix</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.Q_ix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.R_ix">
<code class="descname">R_ix</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.R_ix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.X_as">
<code class="descname">X_as</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.X_as" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.X_pix">
<code class="descname">X_pix</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.X_pix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.Y_as">
<code class="descname">Y_as</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.Y_as" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.Y_pix">
<code class="descname">Y_pix</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.Y_pix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.exptime">
<code class="descname">exptime</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.exptime" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.Extraction.Extraction.get_counts">
<code class="descname">get_counts</code><span class="sig-paren">(</span><em>the_spec='specf'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extraction.html#Extraction.get_counts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extraction.Extraction.get_counts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns [wavelength, counts] spectrum.</p>
<p>wavelength in nm
counts in raw counts</p>
<p>Both are around 250 pixels long</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>the_spec</strong> &#8211; Either &#8216;spec&#8217; for the top-hat extracted
spectrum or &#8216;specw&#8217; for the weighted
(so called optimal) extraction, &#8216;specf&#8217; for the
fractional extraction, or &#8216;specwf&#8217; for weighted
optimal extraciton.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SEDMr.Extraction.Extraction.get_dlambda">
<code class="descname">get_dlambda</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extraction.html#Extraction.get_dlambda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extraction.Extraction.get_dlambda" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dlambda spectrum</p>
</dd></dl>

<dl class="method">
<dt id="SEDMr.Extraction.Extraction.get_exptime">
<code class="descname">get_exptime</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extraction.html#Extraction.get_exptime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extraction.Extraction.get_exptime" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns exptime. If None, returns 1</p>
</dd></dl>

<dl class="method">
<dt id="SEDMr.Extraction.Extraction.get_flambda">
<code class="descname">get_flambda</code><span class="sig-paren">(</span><em>the_spec='specf'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extraction.html#Extraction.get_flambda"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extraction.Extraction.get_flambda" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns [wavelength, Flambda] spectrum.</p>
<p>wavelength in nm
Flambda in Electron/nm/10 min</p>
<p>Both are around 250 pixels long</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>the_spec</strong> &#8211; Either &#8216;spec&#8217; for the top-hat extracted
spectrum or &#8216;specw&#8217; for the weighted
(so called optimal) extraction, &#8216;specf&#8217; for the
fractional extraction, or &#8216;specwf&#8217; for weighted
optimal extraciton.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="SEDMr.Extraction.Extraction.get_lambda_nm">
<code class="descname">get_lambda_nm</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extraction.html#Extraction.get_lambda_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extraction.Extraction.get_lambda_nm" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns lambda spectrum in nm</p>
</dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.hg_lines">
<code class="descname">hg_lines</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.hg_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.hgcoef">
<code class="descname">hgcoef</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.hgcoef" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.lamcoeff">
<code class="descname">lamcoeff</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.lamcoeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.lamnrms">
<code class="descname">lamnrms</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.lamnrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.lamrms">
<code class="descname">lamrms</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.lamrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.mdn_coeff">
<code class="descname">mdn_coeff</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.mdn_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.ok">
<code class="descname">ok</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.ok" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.poly">
<code class="descname">poly</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.poly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.seg_id">
<code class="descname">seg_id</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.seg_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.spec">
<code class="descname">spec</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.specf">
<code class="descname">specf</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.specf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.specw">
<code class="descname">specw</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.specw" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.specwf">
<code class="descname">specwf</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.specwf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.trace_sigma">
<code class="descname">trace_sigma</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.trace_sigma" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.xrange">
<code class="descname">xrange</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.xrange" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.xreflam">
<code class="descname">xreflam</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.xreflam" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.xrefpix">
<code class="descname">xrefpix</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.xrefpix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Extraction.Extraction.yrange">
<code class="descname">yrange</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Extraction.Extraction.yrange" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-SEDMr.Extractor">
<span id="sedmr-extractor-module"></span><h2>3.8. SEDMr.Extractor module<a class="headerlink" href="#module-SEDMr.Extractor" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.Extractor.Gaussian_2D">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">Gaussian_2D</code><span class="sig-paren">(</span><em>xdata_tuple</em>, <em>amplitude</em>, <em>xo</em>, <em>yo</em>, <em>sigma_x</em>, <em>sigma_y</em>, <em>theta</em>, <em>offset</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#Gaussian_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.Gaussian_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a 2D gaussian centered in xo, yo with the parameters specified.
xdata_tuple: coordinates of the points where the 2D Gaussian is computed.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.add">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">add</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.addcon">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">addcon</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#addcon"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.addcon" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.atm_dispersion_positions">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">atm_dispersion_positions</code><span class="sig-paren">(</span><em>PRLLTC</em>, <em>pos</em>, <em>leff</em>, <em>airmass</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#atm_dispersion_positions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.atm_dispersion_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of (X,Y) positions indicating trace of atmospheric dispersion</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>PRLLTC</strong> &#8211; parralactic angle in Angle class</li>
<li><strong>pos</strong> &#8211; (x,y) position of source in arcsec at wavelength leff</li>
<li><strong>leff</strong> &#8211; Effective wavelength, micron</li>
<li><strong>airmass</strong> &#8211; Atmospheric airmass. Note, if airmass=1 there&#8217;s no dispersion</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>[ (x0,y0) ... (xn,yn) ]</p>
<p>Note: if airmass=1, then the list is equivalent of [ pos ]</p>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">List of positions of the source in arcsec</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.bgd_level">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">bgd_level</code><span class="sig-paren">(</span><em>extractions</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#bgd_level"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.bgd_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove background from extractions</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.c_to_nm">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">c_to_nm</code><span class="sig-paren">(</span><em>coefficients</em>, <em>pix</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#c_to_nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.c_to_nm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.combine4">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">combine4</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>C</em>, <em>D</em>, <em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#combine4"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.combine4" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates outname which is == A-(B+C+D)/3</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.combines">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">combines</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>C</em>, <em>D</em>, <em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#combines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.combines" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates outname with A+B+C+D</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.divide">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">divide</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#divide"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.divide" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.find_positions_ellipse">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">find_positions_ellipse</code><span class="sig-paren">(</span><em>xy</em>, <em>h</em>, <em>k</em>, <em>a</em>, <em>b</em>, <em>A</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#find_positions_ellipse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.find_positions_ellipse" title="Permalink to this definition">¶</a></dt>
<dd><p>xy: Vector with pairs [[x0, y0], [x1, y1]] of coordinates.
a: semi-major axis of ellipse in X axis.
b: semi-minor axis of ellipse in Y axis.
h: central point ellipse in X axis.
k: central point ellipse in Y axis.
A: angle of rotation of ellipse in radians (clockwise).</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.gunzip">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">gunzip</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#gunzip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.gunzip" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.gzip">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">gzip</code><span class="sig-paren">(</span><em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#gzip"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.gzip" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.handle_A">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">handle_A</code><span class="sig-paren">(</span><em>A</em>, <em>fine</em>, <em>outname=None</em>, <em>standard=None</em>, <em>Aoffset=None</em>, <em>radius=2</em>, <em>flat_corrections=None</em>, <em>nosky=False</em>, <em>lmin=650</em>, <em>lmax=700</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#handle_A"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.handle_A" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads IFU frame &#8220;A&#8221; and extracts spectra using &#8220;fine&#8221;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>string</em>) &#8211; filename of ifu FITS file to extract from.</li>
<li><strong>fine</strong> (<em>string</em>) &#8211; filename of NumPy file with locations + wavelength
soln</li>
<li><strong>outname</strong> (<em>string</em>) &#8211; filename to write results to</li>
<li><strong>Aoffset</strong> (<em>2tuple</em>) &#8211; X (nm)/Y (pix) shift to apply for flexure correction</li>
<li><strong>radius</strong> (<em>float</em>) &#8211; Extraction radius in arcsecond</li>
<li><strong>flat_corrections</strong> (<em>list</em>) &#8211; A list of FlatCorrection objects for
correcting the extraction</li>
<li><strong>nosky</strong> (<em>Boolean</em>) &#8211; if True don&#8217;t subtract sky, merely sum in aperture</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">{&#8216;ph_10m_nm&#8217;: Flux in photon / 10 m / nanometer integrated
&#8216;nm&#8217;: Wavelength solution in nm
&#8216;N_spax&#8217;: Total number of spaxels that created ph_10m_nm
&#8216;skyph&#8217;: Sky flux in photon / 10 m / nanometer / spaxel
&#8216;radius_as&#8217;: Extraction radius in arcsec
&#8216;pos&#8217;: X/Y extraction location of spectrum in arcsec}</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">The extracted spectrum, a dictionary</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.handle_AB">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">handle_AB</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>fine</em>, <em>outname=None</em>, <em>Aoffset=None</em>, <em>Boffset=None</em>, <em>radius=2</em>, <em>flat_corrections=None</em>, <em>nosky=False</em>, <em>lmin=650</em>, <em>lmax=700</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#handle_AB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.handle_AB" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads IFU frame &#8220;A&#8221; and &#8220;B&#8221; and extracts A-B spectra using &#8220;fine&#8221;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>string</em>) &#8211; filename of ifu FITS file to extract from.</li>
<li><strong>B</strong> (<em>string</em>) &#8211; filename of ifu FITS file to extract from.</li>
<li><strong>fine</strong> (<em>string</em>) &#8211; filename of NumPy file with locations + wavelength soln.</li>
<li><strong>outname</strong> (<em>string</em>) &#8211; filename to write results to</li>
<li><strong>Aoffset</strong> (<em>2tuple</em>) &#8211; X (nm)/Y (pix) shift to apply for flexure correction</li>
<li><strong>Boffset</strong> (<em>2tuple</em>) &#8211; X (nm)/Y (pix) shift to apply for flexure correction</li>
<li><strong>radius</strong> (<em>float</em>) &#8211; Extraction radius in arcsecond</li>
<li><strong>flat_corrections</strong> (<em>list</em>) &#8211; A list of FlatCorrection objects for
correcting the extraction</li>
<li><strong>nosky</strong> (<em>Boolean</em>) &#8211; if True don&#8217;t subtract sky, merely sum in aperture</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">{&#8216;ph_10m_nm&#8217;: Flux in photon / 10 m / nanometer integrated
&#8216;var&#8217;
&#8216;nm&#8217;: Wavelength solution in nm
&#8216;N_spaxA&#8217;: Total number of &#8220;A&#8221; spaxels
&#8216;N_spaxB&#8217;: Total number of &#8220;B&#8221; spaxels
&#8216;skyph&#8217;: Sky flux in photon / 10 m / nanometer / spaxel
&#8216;radius_as&#8217;: Extraction radius in arcsec
&#8216;pos&#8217;: X/Y extraction location of spectrum in arcsec}</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">The extracted spectrum, a dictionary</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.handle_Flat">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">handle_Flat</code><span class="sig-paren">(</span><em>A</em>, <em>fine</em>, <em>outname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#handle_Flat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.handle_Flat" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads IFU Flat frame &#8220;A&#8221; and extracts spectra using &#8220;fine&#8221;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>string</em>) &#8211; filename of ifu FITS file to extract from.</li>
<li><strong>fine</strong> (<em>string</em>) &#8211; filename of NumPy file with locations + wavelength soln.</li>
<li><strong>outname</strong> (<em>string</em>) &#8211; filename to write results to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">None</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.handle_Std">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">handle_Std</code><span class="sig-paren">(</span><em>A</em>, <em>fine</em>, <em>outname=None</em>, <em>standard=None</em>, <em>Aoffset=None</em>, <em>flat_corrections=None</em>, <em>lmin=650</em>, <em>lmax=700</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#handle_Std"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.handle_Std" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads IFU frame &#8220;A&#8221; and extracts standard star spectra using &#8220;fine&#8221;.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>string</em>) &#8211; filename of ifu FITS file to extract from.</li>
<li><strong>fine</strong> (<em>string</em>) &#8211; filename of NumPy file with locations + wavelength soln</li>
<li><strong>outname</strong> (<em>string</em>) &#8211; filename to write results to</li>
<li><strong>standard</strong> (<em>string</em>) &#8211; name of standard star</li>
<li><strong>Aoffset</strong> (<em>2tuple</em>) &#8211; X (nm)/Y (pix) shift to apply for flexure correction</li>
<li><strong>flat_corrections</strong> (<em>list</em>) &#8211; A list of FlatCorrection objects for
correcting the extraction</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">{&#8216;ph_10m_nm&#8217;: Observed flux in photon / 10 m / nm integrated
&#8216;nm&#8217;: Wavelength solution in nm
&#8216;N_spax&#8217;: Total number of spaxels that created ph_10m_nm
&#8216;skyph&#8217;: Sky flux in photon / 10 m / nanometer / spaxel
&#8216;std-correction&#8217;: ratio of observed to reference flux
&#8216;std-maxnm&#8217;: maximum reference wavelength in nm
&#8216;radius_as&#8217;: Extraction radius in arcsec
&#8216;pos&#8217;: X/Y extraction location of spectrum in arcsec}</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">The extracted spectrum, a dictionary</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">None</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.handle_extract">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">handle_extract</code><span class="sig-paren">(</span><em>data</em>, <em>outname=None</em>, <em>fine='fine.npy'</em>, <em>flexure_x_corr_nm=0.0</em>, <em>flexure_y_corr_pix=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#handle_extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.handle_extract" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.identify_bgd_spectra">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">identify_bgd_spectra</code><span class="sig-paren">(</span><em>spectra</em>, <em>pos</em>, <em>inner=3</em>, <em>outer=6</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#identify_bgd_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.identify_bgd_spectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.identify_sky_spectra">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">identify_sky_spectra</code><span class="sig-paren">(</span><em>spectra</em>, <em>pos</em>, <em>inner=3</em>, <em>lmin=650</em>, <em>lmax=700</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#identify_sky_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.identify_sky_spectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.identify_spectra">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">identify_spectra</code><span class="sig-paren">(</span><em>spectra</em>, <em>outname=None</em>, <em>low=-inf</em>, <em>hi=inf</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#identify_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.identify_spectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.identify_spectra_Gauss_fit">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">identify_spectra_Gauss_fit</code><span class="sig-paren">(</span><em>spectra</em>, <em>outname=None</em>, <em>PRLLTC=None</em>, <em>lmin=400</em>, <em>lmax=900</em>, <em>airmass=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#identify_spectra_Gauss_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.identify_spectra_Gauss_fit" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Returns index of spectra picked by Guassian fit.</div></blockquote>
<p>NOTE: Index is counted against the array, not seg_id</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.identify_spectra_gui">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">identify_spectra_gui</code><span class="sig-paren">(</span><em>spectra</em>, <em>outname=None</em>, <em>radius=2</em>, <em>lmin=650</em>, <em>lmax=700</em>, <em>PRLLTC=None</em>, <em>object=&lt;type 'object'&gt;</em>, <em>airmass=1.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#identify_spectra_gui"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.identify_spectra_gui" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns index of spectra picked in GUI.</p>
<p>NOTE: Index is counted against the array, not seg_id</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.imarith">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">imarith</code><span class="sig-paren">(</span><em>operand1</em>, <em>op</em>, <em>operand2</em>, <em>result</em>, <em>doAirmass=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#imarith"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.imarith" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.interp_spectra">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">interp_spectra</code><span class="sig-paren">(</span><em>all_spectra</em>, <em>six</em>, <em>sign=1.0</em>, <em>outname=None</em>, <em>plot=False</em>, <em>corrfile=None</em>, <em>dnm=0</em>, <em>onto=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#interp_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.interp_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Interp spectra onto common grid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>all_spectra</strong> &#8211; </li>
<li><strong>six</strong> &#8211; </li>
<li><strong>dnm</strong> &#8211; Offset (usually for flexure) in nm</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.load_corr">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">load_corr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#load_corr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.load_corr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.measure_flexure">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">measure_flexure</code><span class="sig-paren">(</span><em>sky</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#measure_flexure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.measure_flexure" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure expected (589.3 nm) - measured emission line in nm</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.reject_outliers">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">reject_outliers</code><span class="sig-paren">(</span><em>data</em>, <em>m=2.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#reject_outliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.reject_outliers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.subtract">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">subtract</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#subtract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.subtract" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Extractor.to_image">
<code class="descclassname">SEDMr.Extractor.</code><code class="descname">to_image</code><span class="sig-paren">(</span><em>spectra</em>, <em>meta</em>, <em>outname</em>, <em>posA=None</em>, <em>posB=None</em>, <em>adcpos=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Extractor.html#to_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Extractor.to_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert spectra list into image_[outname].pdf</p>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.FindSpectra">
<span id="sedmr-findspectra-module"></span><h2>3.9. SEDMr.FindSpectra module<a class="headerlink" href="#module-SEDMr.FindSpectra" title="Permalink to this headline">¶</a></h2>
<p>Finds SEDM spectra based on a sextractor segmentation map</p>
<blockquote>
<div>[c] 2014 Nick Konidaris</div></blockquote>
<dl class="attribute">
<dt id="SEDMr.FindSpectra.Coord">
<code class="descclassname">SEDMr.FindSpectra.</code><code class="descname">Coord</code><a class="headerlink" href="#SEDMr.FindSpectra.Coord" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">XY</span></code></p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.FindSpectra.ds9_line_str">
<code class="descclassname">SEDMr.FindSpectra.</code><code class="descname">ds9_line_str</code><span class="sig-paren">(</span><em>startx</em>, <em>starty</em>, <em>endx</em>, <em>endy</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FindSpectra.html#ds9_line_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FindSpectra.ds9_line_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string representing a line in ds9</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.FindSpectra.find_segments">
<code class="descclassname">SEDMr.FindSpectra.</code><code class="descname">find_segments</code><span class="sig-paren">(</span><em>segmap=None</em>, <em>obj=None</em>, <em>order=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FindSpectra.html#find_segments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FindSpectra.find_segments" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the segments in obj by tracing ridgelines identified in
the segmentation map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>segmap</strong> (<em>[int,int]</em>) &#8211; Segmentation map image, first segment is
1 .. max(segmap)</li>
<li><strong>obj</strong> (<em>[float,float]</em>) &#8211; Image data to trace over</li>
<li><strong>order</strong> (<em>int</em>) &#8211; The order of the polynomial used in coeff_ys</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>Returns a list with length equal to
the max(segmap) segmentation map Dictionaries containing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>   <span class="s2">&quot;seg_cnt&quot;</span><span class="p">:</span> <span class="n">Segment</span> <span class="n">ID</span> <span class="n">number</span><span class="p">,</span>
    <span class="s2">&quot;xs&quot;</span><span class="p">:</span> <span class="n">List</span> <span class="n">of</span> <span class="n">x</span> <span class="n">positions</span> <span class="n">of</span> <span class="n">trace</span><span class="p">,</span>
    <span class="s2">&quot;mean_ys&quot;</span><span class="p">:</span> <span class="n">Measured</span> <span class="n">Y</span> <span class="n">position</span> <span class="p">(</span><span class="n">average</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">trace</span><span class="p">,</span>
    <span class="s2">&quot;coeff_ys&quot;</span><span class="p">:</span> <span class="n">polyfit</span> <span class="n">coefficients</span> <span class="n">to</span> <span class="n">the</span> <span class="n">mean_ys</span><span class="p">,</span>
    <span class="s2">&quot;trace_sigma&quot;</span><span class="p">:</span> <span class="n">Width</span> <span class="n">of</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">pixels</span> <span class="p">(</span><span class="mi">1</span> <span class="n">sigma</span><span class="p">),</span>
    <span class="s2">&quot;ok&quot;</span><span class="p">:</span> <span class="n">Trace</span> <span class="n">has</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">50</span> <span class="n">pixels</span>     <span class="p">}</span>
</pre></div>
</div>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of dict</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.FindSpectra.find_segments_helper">
<code class="descclassname">SEDMr.FindSpectra.</code><code class="descname">find_segments_helper</code><span class="sig-paren">(</span><em>seg_cnt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FindSpectra.html#find_segments_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FindSpectra.find_segments_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Trace a single spaxel segment and return the solution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>seg_cnt</strong> (<em>int</em>) &#8211; the segment number</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Returns a segmentation map Dictionary
containing:<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">{</span>   <span class="s2">&quot;seg_cnt&quot;</span><span class="p">:</span> <span class="n">Segment</span> <span class="n">ID</span> <span class="n">number</span><span class="p">,</span>
    <span class="s2">&quot;xs&quot;</span><span class="p">:</span> <span class="n">List</span> <span class="n">of</span> <span class="n">x</span> <span class="n">positions</span> <span class="n">of</span> <span class="n">trace</span><span class="p">,</span>
    <span class="s2">&quot;mean_ys&quot;</span><span class="p">:</span> <span class="n">Measured</span> <span class="n">Y</span> <span class="n">position</span> <span class="p">(</span><span class="n">average</span><span class="p">)</span> <span class="n">of</span> <span class="n">the</span> <span class="n">trace</span><span class="p">,</span>
    <span class="s2">&quot;coeff_ys&quot;</span><span class="p">:</span> <span class="n">polyfit</span> <span class="n">coefficients</span> <span class="n">to</span> <span class="n">the</span> <span class="n">mean_ys</span><span class="p">,</span>
    <span class="s2">&quot;trace_sigma&quot;</span><span class="p">:</span> <span class="n">Width</span> <span class="n">of</span> <span class="n">trace</span> <span class="ow">in</span> <span class="n">pixels</span> <span class="p">(</span><span class="mi">1</span> <span class="n">sigma</span><span class="p">),</span>
    <span class="s2">&quot;ok&quot;</span><span class="p">:</span> <span class="n">Trace</span> <span class="n">has</span> <span class="n">more</span> <span class="n">than</span> <span class="mi">50</span> <span class="n">pixels</span>     <span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.FindSpectra.load_data">
<code class="descclassname">SEDMr.FindSpectra.</code><code class="descname">load_data</code><span class="sig-paren">(</span><em>segmapfn</em>, <em>objfn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FindSpectra.html#load_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FindSpectra.load_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns HDUs from files segmapfn and objfn.</p>
<p>load_data is a thin wrapper around pyfits</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.FindSpectra.spanrange">
<code class="descclassname">SEDMr.FindSpectra.</code><code class="descname">spanrange</code><span class="sig-paren">(</span><em>locs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FindSpectra.html#spanrange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FindSpectra.spanrange" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a pair of coordinates where index values are true for a 2d array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>locs[d1,d2]</strong> &#8211; Boolean array of coordinates</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">[[min x, min y], [max x, max y]]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.FindSpectra.write_reports">
<code class="descclassname">SEDMr.FindSpectra.</code><code class="descname">write_reports</code><span class="sig-paren">(</span><em>segments</em>, <em>outname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FindSpectra.html#write_reports"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FindSpectra.write_reports" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.FindSpectra.write_segments">
<code class="descclassname">SEDMr.FindSpectra.</code><code class="descname">write_segments</code><span class="sig-paren">(</span><em>segments</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FindSpectra.html#write_segments"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FindSpectra.write_segments" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.FitsCube">
<span id="sedmr-fitscube-module"></span><h2>3.10. SEDMr.FitsCube module<a class="headerlink" href="#module-SEDMr.FitsCube" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="SEDMr.FitsCube.FitsCube">
<em class="property">class </em><code class="descclassname">SEDMr.FitsCube.</code><code class="descname">FitsCube</code><a class="reference internal" href="_modules/SEDMr/FitsCube.html#FitsCube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FitsCube.FitsCube" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="SEDMr.FitsCube.FitsCube.cube">
<code class="descname">cube</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.FitsCube.FitsCube.cube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.FitsCube.FitsCube.cube_snr">
<code class="descname">cube_snr</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.FitsCube.FitsCube.cube_snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.FitsCube.FitsCube.header">
<code class="descname">header</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.FitsCube.FitsCube.header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.FitsCube.FitsCube.load">
<code class="descname">load</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FitsCube.html#FitsCube.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FitsCube.FitsCube.load" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.FitsCube.FitsCube.locations">
<code class="descname">locations</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.FitsCube.FitsCube.locations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.FitsCube.FitsCube.rect_cube">
<code class="descname">rect_cube</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.FitsCube.FitsCube.rect_cube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.FitsCube.FitsCube.rect_cube_snr">
<code class="descname">rect_cube_snr</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.FitsCube.FitsCube.rect_cube_snr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-SEDMr.Flat">
<span id="sedmr-flat-module"></span><h2>3.11. SEDMr.Flat module<a class="headerlink" href="#module-SEDMr.Flat" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.Flat.measure_flat">
<code class="descclassname">SEDMr.Flat.</code><code class="descname">measure_flat</code><span class="sig-paren">(</span><em>extraction</em>, <em>meta</em>, <em>lamstart=700</em>, <em>lamend=900</em>, <em>outfile='flat.npy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Flat.html#measure_flat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Flat.measure_flat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.FlatCorrection">
<span id="sedmr-flatcorrection-module"></span><h2>3.12. SEDMr.FlatCorrection module<a class="headerlink" href="#module-SEDMr.FlatCorrection" title="Permalink to this headline">¶</a></h2>
<p>SED Machine flat field class
(c) 2015 Nick Konidaris</p>
<p>This class is an abstract wrapper around a flat-field correciton</p>
<dl class="class">
<dt id="SEDMr.FlatCorrection.FlatCorrection">
<em class="property">class </em><code class="descclassname">SEDMr.FlatCorrection.</code><code class="descname">FlatCorrection</code><span class="sig-paren">(</span><em>seg_id=None</em>, <em>correction=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FlatCorrection.html#FlatCorrection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FlatCorrection.FlatCorrection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>SED machine flat field correction</p>
<p>Generally there are several thousand such Extractions that are held for
a single 2k x 2k frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>seg_id</strong> (<em>int</em>) &#8211; Number from 1 to the maximum segment number. The segment
number is generated by sextractor.</li>
<li><strong>correction</strong> (<em>object</em>) &#8211; Some type of correction object.</li>
<li><strong>get_correction</strong> (<em>lam</em>) &#8211; Returns the correction value for a given wavelength. Current default is no wavelength dependence.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Examples:</p>
<dl class="attribute">
<dt id="SEDMr.FlatCorrection.FlatCorrection.correction">
<code class="descname">correction</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.FlatCorrection.FlatCorrection.correction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.FlatCorrection.FlatCorrection.get_correction">
<code class="descname">get_correction</code><span class="sig-paren">(</span><em>lam</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/FlatCorrection.html#FlatCorrection.get_correction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.FlatCorrection.FlatCorrection.get_correction" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns correction spectrum, a number that averages about 1 for the frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lam</strong> &#8211; Wavelength in nm</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="SEDMr.FlatCorrection.FlatCorrection.seg_id">
<code class="descname">seg_id</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.FlatCorrection.FlatCorrection.seg_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-SEDMr.Flexure">
<span id="sedmr-flexure-module"></span><h2>3.13. SEDMr.Flexure module<a class="headerlink" href="#module-SEDMr.Flexure" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.Flexure.measure_flexure_x">
<code class="descclassname">SEDMr.Flexure.</code><code class="descname">measure_flexure_x</code><span class="sig-paren">(</span><em>fine</em>, <em>HDUlist</em>, <em>plot=True</em>, <em>dY=0</em>, <em>skyline=589.0</em>, <em>lamstart=1000.0</em>, <em>lamratio=0.9958333333333333</em>, <em>lamlen=250</em>, <em>extract_width=3</em>, <em>skywidth=9</em>, <em>outfile='dX'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Flexure.html#measure_flexure_x"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Flexure.measure_flexure_x" title="Permalink to this definition">¶</a></dt>
<dd><p>Measures flexure in X direction, returns pixel offset</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fine</strong> &#8211; List of Extraction object, the fine loc + wave solution for
each spectrum</li>
<li><strong>HDUlist</strong> &#8211; Pyfits object for the spectrum to measure</li>
<li><strong>plot</strong> &#8211; Plot + save results to a file</li>
<li><strong>dY</strong> &#8211; the measured pixel flexure in Y direction to account for</li>
<li><strong>skyline</strong> (<em>float</em>) &#8211; The night skyline to centroid on in nm</li>
<li><strong>skywidth</strong> (<em>float</em>) &#8211; Fit gaussian to the ROI of (skyline-skywidth to
skyline+skywidth) in nm.</li>
<li><strong>extract_width</strong> (<em>int</em>) &#8211; Number of pixels to extract spectrum around</li>
<li><strong>See Wavelength.fiducial spectrum for following</strong> (<em>-</em>) &#8211; </li>
<li><strong>lamstart</strong> &#8211; Wavelength to start the grid on, default 1000 nm</li>
<li><strong>lamratio</strong> &#8211; Resolution of sed machine</li>
<li><strong>lamlen</strong> &#8211; Length of spectrum</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Offset number of pixels in X direction.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Flexure.measure_flexure_y">
<code class="descclassname">SEDMr.Flexure.</code><code class="descname">measure_flexure_y</code><span class="sig-paren">(</span><em>fine</em>, <em>HDUlist</em>, <em>profwidth=5</em>, <em>plot=False</em>, <em>outname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Flexure.html#measure_flexure_y"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Flexure.measure_flexure_y" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.GUI">
<span id="sedmr-gui-module"></span><h2>3.14. SEDMr.GUI module<a class="headerlink" href="#module-SEDMr.GUI" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="SEDMr.GUI.MouseCross">
<em class="property">class </em><code class="descclassname">SEDMr.GUI.</code><code class="descname">MouseCross</code><span class="sig-paren">(</span><em>ax</em>, <em>radius_as=3</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#MouseCross"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.MouseCross" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Draw a cursor with the mouse cursor</p>
<dl class="method">
<dt id="SEDMr.GUI.MouseCross.show_cross">
<code class="descname">show_cross</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#MouseCross.show_cross"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.MouseCross.show_cross" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.GUI.MouseCross.size_cross">
<code class="descname">size_cross</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#MouseCross.size_cross"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.MouseCross.size_cross" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="SEDMr.GUI.PositionPicker">
<em class="property">class </em><code class="descclassname">SEDMr.GUI.</code><code class="descname">PositionPicker</code><span class="sig-paren">(</span><em>spectra=None</em>, <em>pointsize=55</em>, <em>bgd_sub=False</em>, <em>radius_as=3</em>, <em>objname=None</em>, <em>lmin=600</em>, <em>lmax=650</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#PositionPicker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.PositionPicker" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class is used to select an extraction point in a data cube</p>
<dl class="attribute">
<dt id="SEDMr.GUI.PositionPicker.Vs">
<code class="descname">Vs</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.PositionPicker.Vs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.PositionPicker.Xs">
<code class="descname">Xs</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.PositionPicker.Xs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.PositionPicker.Ys">
<code class="descname">Ys</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.PositionPicker.Ys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.GUI.PositionPicker.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#PositionPicker.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.PositionPicker.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Event call handler for Picker gui.</p>
</dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.PositionPicker.bgd_sub">
<code class="descname">bgd_sub</code><em class="property"> = False</em><a class="headerlink" href="#SEDMr.GUI.PositionPicker.bgd_sub" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.GUI.PositionPicker.draw_cube">
<code class="descname">draw_cube</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#PositionPicker.draw_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.PositionPicker.draw_cube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.PositionPicker.picked">
<code class="descname">picked</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.PositionPicker.picked" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.PositionPicker.pointsize">
<code class="descname">pointsize</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.PositionPicker.pointsize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.PositionPicker.radius_as">
<code class="descname">radius_as</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.PositionPicker.radius_as" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.PositionPicker.spectra">
<code class="descname">spectra</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.PositionPicker.spectra" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="SEDMr.GUI.WaveFixer">
<em class="property">class </em><code class="descclassname">SEDMr.GUI.</code><code class="descname">WaveFixer</code><span class="sig-paren">(</span><em>cube=None</em>, <em>pointsize=65</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#WaveFixer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.WaveFixer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class is used to fix bad wavelength solutions</p>
<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.KT">
<code class="descname">KT</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.KT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.X1">
<code class="descname">X1</code><em class="property"> = []</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.X1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.X2">
<code class="descname">X2</code><em class="property"> = []</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.X2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.Y1">
<code class="descname">Y1</code><em class="property"> = []</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.Y1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.GUI.WaveFixer.__call__">
<code class="descname">__call__</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#WaveFixer.__call__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.WaveFixer.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>Event call handler for Picker gui.</p>
</dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.ax_cube">
<code class="descname">ax_cube</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.ax_cube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.ax_spec">
<code class="descname">ax_spec</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.ax_spec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.cube">
<code class="descname">cube</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.cube" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.GUI.WaveFixer.draw_cube">
<code class="descname">draw_cube</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#WaveFixer.draw_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.WaveFixer.draw_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw the data cube</p>
</dd></dl>

<dl class="method">
<dt id="SEDMr.GUI.WaveFixer.draw_spectra">
<code class="descname">draw_spectra</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#WaveFixer.draw_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.WaveFixer.draw_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw nearest spectra</p>
</dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.fig">
<code class="descname">fig</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.fig" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.GUI.WaveFixer.handle_button_press">
<code class="descname">handle_button_press</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#WaveFixer.handle_button_press"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.WaveFixer.handle_button_press" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.GUI.WaveFixer.mode_switch">
<code class="descname">mode_switch</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/GUI.html#WaveFixer.mode_switch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.GUI.WaveFixer.mode_switch" title="Permalink to this definition">¶</a></dt>
<dd><p>Toggle operating mode between Display and Select</p>
</dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.picked">
<code class="descname">picked</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.picked" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.pointsize">
<code class="descname">pointsize</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.pointsize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.GUI.WaveFixer.state">
<code class="descname">state</code><em class="property"> = 'Display'</em><a class="headerlink" href="#SEDMr.GUI.WaveFixer.state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-SEDMr.IO">
<span id="sedmr-io-module"></span><h2>3.15. SEDMr.IO module<a class="headerlink" href="#module-SEDMr.IO" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.IO.convert_spectra_to_img">
<code class="descclassname">SEDMr.IO.</code><code class="descname">convert_spectra_to_img</code><span class="sig-paren">(</span><em>spectra</em>, <em>CRVAL1</em>, <em>CRPIX1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/IO.html#convert_spectra_to_img"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.IO.convert_spectra_to_img" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.IO.convert_spectra_to_recarray">
<code class="descclassname">SEDMr.IO.</code><code class="descname">convert_spectra_to_recarray</code><span class="sig-paren">(</span><em>spectra</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/IO.html#convert_spectra_to_recarray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.IO.convert_spectra_to_recarray" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an Numpy recarray version of spectra</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.IO.exp_fid_wave">
<code class="descclassname">SEDMr.IO.</code><code class="descname">exp_fid_wave</code><span class="sig-paren">(</span><em>CRVAL1=239.5</em>, <em>CRPIX1=88.98</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/IO.html#exp_fid_wave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.IO.exp_fid_wave" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a fiducial wavelength grid appropraite for FITS representation</p>
<p>Computation performed with Mathematica</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.IO.readfits">
<code class="descclassname">SEDMr.IO.</code><code class="descname">readfits</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/IO.html#readfits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.IO.readfits" title="Permalink to this definition">¶</a></dt>
<dd><p>Read fits file at path or path.gz</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.IO.readspec">
<code class="descclassname">SEDMr.IO.</code><code class="descname">readspec</code><span class="sig-paren">(</span><em>path</em>, <em>corrname='std-correction.npy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/IO.html#readspec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.IO.readspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Read numpy spec file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em>) &#8211; full filespec for numpy sp_*.npy file</li>
<li><strong>corrname</strong> (<em>str</em>) &#8211; flux correction file name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">in nm
spectrum array [N]: in erg/s/cm2/ang
sky spectrum array [N]: in spectrum units
standard deviation of spectrum [N]: in spectrum units
Spectrum object: full spectrum from where above derived
meta {}: The meta dictionary associated with the spectrum</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">wavelength array [N]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.IO.write_cube">
<code class="descclassname">SEDMr.IO.</code><code class="descname">write_cube</code><span class="sig-paren">(</span><em>spectra</em>, <em>headers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/IO.html#write_cube"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.IO.write_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a FITS file with all spectra written.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.IO.writefits">
<code class="descclassname">SEDMr.IO.</code><code class="descname">writefits</code><span class="sig-paren">(</span><em>towrite</em>, <em>fname</em>, <em>no_lossy_compress=False</em>, <em>clobber=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/IO.html#writefits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.IO.writefits" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.Imcombine">
<span id="sedmr-imcombine-module"></span><h2>3.16. SEDMr.Imcombine module<a class="headerlink" href="#module-SEDMr.Imcombine" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.Imcombine.imcombine">
<code class="descclassname">SEDMr.Imcombine.</code><code class="descname">imcombine</code><span class="sig-paren">(</span><em>filelist</em>, <em>out</em>, <em>listfile=None</em>, <em>bpmask=None</em>, <em>reject='none'</em>, <em>nlow=None</em>, <em>nhigh=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Imcombine.html#imcombine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Imcombine.imcombine" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience wrapper around IRAF task imcombine</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filelist</strong> (<em>list of str</em>) &#8211; The list of files to imcombine</li>
<li><strong>out</strong> (<em>str</em>) &#8211; The full path to the output file</li>
<li><strong>bpmask</strong> (<em>str</em>) &#8211; The full path to the bad pixel mask</li>
<li><strong>reject</strong> (<em>str</em>) &#8211; none, minmax, sigclip, avsigclip, pclip</li>
<li><strong>nlow,nhigh</strong> (<em>int,int</em>) &#8211; Parameters for minmax rejection, see iraf docs</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Side effects:</dt>
<dd>Creates the imcombined file at location <cite>out</cite></dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.Plan">
<span id="sedmr-plan-module"></span><h2>3.17. SEDMr.Plan module<a class="headerlink" href="#module-SEDMr.Plan" title="Permalink to this headline">¶</a></h2>
<p>Generate Makefile for reducing ifu data</p>
<dl class="function">
<dt id="SEDMr.Plan.MF_AB">
<code class="descclassname">SEDMr.Plan.</code><code class="descname">MF_AB</code><span class="sig-paren">(</span><em>objname</em>, <em>obsnum</em>, <em>A</em>, <em>B</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Plan.html#MF_AB"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Plan.MF_AB" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the MF entry for an A-B observation</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Plan.MF_imcombine">
<code class="descclassname">SEDMr.Plan.</code><code class="descname">MF_imcombine</code><span class="sig-paren">(</span><em>objname</em>, <em>files</em>, <em>dependencies=''</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Plan.html#MF_imcombine"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Plan.MF_imcombine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Plan.MF_single">
<code class="descclassname">SEDMr.Plan.</code><code class="descname">MF_single</code><span class="sig-paren">(</span><em>objname</em>, <em>obsnum</em>, <em>ifile</em>, <em>standard=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Plan.html#MF_single"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Plan.MF_single" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the MF entry for a observation with a single file.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Plan.extract_info">
<code class="descclassname">SEDMr.Plan.</code><code class="descname">extract_info</code><span class="sig-paren">(</span><em>infiles</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Plan.html#extract_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Plan.extract_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Plan.identify_observations">
<code class="descclassname">SEDMr.Plan.</code><code class="descname">identify_observations</code><span class="sig-paren">(</span><em>headers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Plan.html#identify_observations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Plan.identify_observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of object name, observation number, and list of files.</p>
<p>e.g. will return:</p>
<dl class="docutils">
<dt>{&#8216;STD-BD+25d4655&#8217;: {1: [&#8216;...&#8217;]}, {2: [&#8216;...&#8217;]},</dt>
<dd>&#8216;PTF14dvo&#8217;: {1: [&#8216;...&#8217;, &#8216;...&#8217;]}}</dd>
</dl>
<p>where STD-BD+25d4655 was observed at the beginning and end of night. SN
14dov was observed once with A-B.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Plan.make_plan">
<code class="descclassname">SEDMr.Plan.</code><code class="descname">make_plan</code><span class="sig-paren">(</span><em>headers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Plan.html#make_plan"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Plan.make_plan" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert headers to a makefile, assuming headers sorted by JD.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Plan.to_makefile">
<code class="descclassname">SEDMr.Plan.</code><code class="descname">to_makefile</code><span class="sig-paren">(</span><em>objs</em>, <em>calibs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Plan.html#to_makefile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Plan.to_makefile" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.RemoveBackground">
<span id="sedmr-removebackground-module"></span><h2>3.18. SEDMr.RemoveBackground module<a class="headerlink" href="#module-SEDMr.RemoveBackground" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.RemoveBackground.go">
<code class="descclassname">SEDMr.RemoveBackground.</code><code class="descname">go</code><span class="sig-paren">(</span><em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/RemoveBackground.html#go"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.RemoveBackground.go" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.RemoveBackground.grow">
<code class="descclassname">SEDMr.RemoveBackground.</code><code class="descname">grow</code><span class="sig-paren">(</span><em>img</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/RemoveBackground.html#grow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.RemoveBackground.grow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.RemoveBackground.handle_path">
<code class="descclassname">SEDMr.RemoveBackground.</code><code class="descname">handle_path</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/RemoveBackground.html#handle_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.RemoveBackground.handle_path" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.RemoveBackground.remove">
<code class="descclassname">SEDMr.RemoveBackground.</code><code class="descname">remove</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/RemoveBackground.html#remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.RemoveBackground.remove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.Roller">
<span id="sedmr-roller-module"></span><h2>3.19. SEDMr.Roller module<a class="headerlink" href="#module-SEDMr.Roller" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.Roller.roll_file">
<code class="descclassname">SEDMr.Roller.</code><code class="descname">roll_file</code><span class="sig-paren">(</span><em>infile</em>, <em>X</em>, <em>Y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Roller.html#roll_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Roller.roll_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Load fits infile and roll it in X,Y</p>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.SexLamps">
<span id="sedmr-sexlamps-module"></span><h2>3.20. SEDMr.SexLamps module<a class="headerlink" href="#module-SEDMr.SexLamps" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.SexLamps.go">
<code class="descclassname">SEDMr.SexLamps.</code><code class="descname">go</code><span class="sig-paren">(</span><em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SexLamps.html#go"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SexLamps.go" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.SexSpectra">
<span id="sedmr-sexspectra-module"></span><h2>3.21. SEDMr.SexSpectra module<a class="headerlink" href="#module-SEDMr.SexSpectra" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.SexSpectra.go">
<code class="descclassname">SEDMr.SexSpectra.</code><code class="descname">go</code><span class="sig-paren">(</span><em>paths</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SexSpectra.html#go"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SexSpectra.go" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.SpecArith">
<span id="sedmr-specarith-module"></span><h2>3.22. SEDMr.SpecArith module<a class="headerlink" href="#module-SEDMr.SpecArith" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.SpecArith.specAdd">
<code class="descclassname">SEDMr.SpecArith.</code><code class="descname">specAdd</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>out</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SpecArith.html#specAdd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SpecArith.specAdd" title="Permalink to this definition">¶</a></dt>
<dd><p>Add spectra in A, B and store to out</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.SpecArith.specDiv">
<code class="descclassname">SEDMr.SpecArith.</code><code class="descname">specDiv</code><span class="sig-paren">(</span><em>A</em>, <em>B</em>, <em>out</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SpecArith.html#specDiv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SpecArith.specDiv" title="Permalink to this definition">¶</a></dt>
<dd><p>Divide spectra in A, B and store to out</p>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.SpecNorm">
<span id="sedmr-specnorm-module"></span><h2>3.23. SEDMr.SpecNorm module<a class="headerlink" href="#module-SEDMr.SpecNorm" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.SpecNorm.near_balmer">
<code class="descclassname">SEDMr.SpecNorm.</code><code class="descname">near_balmer</code><span class="sig-paren">(</span><em>lam</em>, <em>Rwindow=0.02</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SpecNorm.html#near_balmer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SpecNorm.near_balmer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="SEDMr.SpecNorm.normalizer">
<em class="property">class </em><code class="descclassname">SEDMr.SpecNorm.</code><code class="descname">normalizer</code><span class="sig-paren">(</span><em>wave</em>, <em>flux</em>, <em>sss</em>, <em>window=15.0</em>, <em>name=None</em>, <em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SpecNorm.html#normalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SpecNorm.normalizer" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>An interactive spline fitting routine for determining the continuum</dt>
<dd>level of a spectrum.</dd>
</dl>
<dl class="method">
<dt id="SEDMr.SpecNorm.normalizer.onclick">
<code class="descname">onclick</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SpecNorm.html#normalizer.onclick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SpecNorm.normalizer.onclick" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.SpecNorm.normalizer.onpick">
<code class="descname">onpick</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SpecNorm.html#normalizer.onpick"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SpecNorm.normalizer.onpick" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.SpecNorm.normalizer.ontype">
<code class="descname">ontype</code><span class="sig-paren">(</span><em>event</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SpecNorm.html#normalizer.ontype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SpecNorm.normalizer.ontype" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-SEDMr.Spectra">
<span id="sedmr-spectra-module"></span><h2>3.24. SEDMr.Spectra module<a class="headerlink" href="#module-SEDMr.Spectra" title="Permalink to this headline">¶</a></h2>
<p>Spectra class definition</p>
<dl class="docutils">
<dt>Functions</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="#SEDMr.Spectra.find_ha" title="SEDMr.Spectra.find_ha"><code class="xref py py-func docutils literal"><span class="pre">find_ha()</span></code></a>   return index closest to Halpha</li>
</ul>
</dd>
</dl>
<dl class="class">
<dt id="SEDMr.Spectra.Spectra">
<em class="property">class </em><code class="descclassname">SEDMr.Spectra.</code><code class="descname">Spectra</code><span class="sig-paren">(</span><em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Spectra.html#Spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Spectra.Spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Spectra class</p>
<dl class="attribute">
<dt id="SEDMr.Spectra.Spectra.KT">
<code class="descname">KT</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Spectra.Spectra.KT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Spectra.Spectra.data">
<code class="descname">data</code><em class="property"> = None</em><a class="headerlink" href="#SEDMr.Spectra.Spectra.data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="SEDMr.Spectra.Spectra.good_positions">
<code class="descname">good_positions</code><em class="property"> = []</em><a class="headerlink" href="#SEDMr.Spectra.Spectra.good_positions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="SEDMr.Spectra.Spectra.to_xyv">
<code class="descname">to_xyv</code><span class="sig-paren">(</span><em>lmin=500</em>, <em>lmax=700</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Spectra.html#Spectra.to_xyv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Spectra.Spectra.to_xyv" title="Permalink to this definition">¶</a></dt>
<dd><p>Method converts a spectral set into X, Y, and intensity tuples</p>
<dl class="docutils">
<dt>X</dt>
<dd>x position relative to center of IFU in arcsec
based on the segmentation map.</dd>
<dt>Y</dt>
<dd>y position relative to center of IFU in arcsec
based on the segmentation map.</dd>
<dt>V</dt>
<dd>median signal strength in the lmin to lmax range.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lmin</strong> (<em>float</em>) &#8211; minimum wavelength in nanometers</li>
<li><strong>lmax</strong> (<em>float</em>) &#8211; maximum wavelength in nanometers</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the X location (in arcsec), Y location
(in arcsec), and the median value (V) of the spaxel
between lmin and lmax</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">X,Y,V tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="SEDMr.Spectra.find_ha">
<code class="descclassname">SEDMr.Spectra.</code><code class="descname">find_ha</code><span class="sig-paren">(</span><em>cc</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Spectra.html#find_ha"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Spectra.find_ha" title="Permalink to this definition">¶</a></dt>
<dd><p>Find out where in X position Halpha falls</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cc</strong> (<em>float vector</em>) &#8211; coefficients of fit giving
wavelength versus spatial position</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">spatial position corresponding to Halpha</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">float</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">assumes spatial position falls between 30 and 100
arcsec and has an accuracy limit of 0.1 arcsec</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.StartObs">
<span id="sedmr-startobs-module"></span><h2>3.25. SEDMr.StartObs module<a class="headerlink" href="#module-SEDMr.StartObs" title="Permalink to this headline">¶</a></h2>
<p>Conduct automatic reduction of SEDM data in <a class="reference external" href="mailto:sedmdrp&#37;&#52;&#48;pharos">sedmdrp<span>&#64;</span>pharos</a></p>
<dl class="docutils">
<dt>Functions</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="#SEDMr.StartObs.go" title="SEDMr.StartObs.go"><code class="xref py py-func docutils literal"><span class="pre">go()</span></code></a>           outer loop waits for new data directory in /scr2/sedm/raw</li>
<li><a class="reference internal" href="#SEDMr.StartObs.ObsLoop" title="SEDMr.StartObs.ObsLoop"><code class="xref py py-func docutils literal"><span class="pre">ObsLoop()</span></code></a>      one night observing loop: processes calibrations and science data</li>
<li><a class="reference internal" href="#SEDMr.StartObs.cpcal" title="SEDMr.StartObs.cpcal"><code class="xref py py-func docutils literal"><span class="pre">cpcal()</span></code></a>        copies calibration images into redux directory</li>
<li><a class="reference internal" href="#SEDMr.StartObs.cpprecal" title="SEDMr.StartObs.cpprecal"><code class="xref py py-func docutils literal"><span class="pre">cpprecal()</span></code></a>     copies calibration images from previous day directory</li>
<li><a class="reference internal" href="#SEDMr.StartObs.find_recent" title="SEDMr.StartObs.find_recent"><code class="xref py py-func docutils literal"><span class="pre">find_recent()</span></code></a>  finds the most recent processed calibration file</li>
<li><a class="reference internal" href="#SEDMr.StartObs.cpnew" title="SEDMr.StartObs.cpnew"><code class="xref py py-func docutils literal"><span class="pre">cpnew()</span></code></a>        copies new images files into redux directory</li>
<li><a class="reference internal" href="#SEDMr.StartObs.proc_stds" title="SEDMr.StartObs.proc_stds"><code class="xref py py-func docutils literal"><span class="pre">proc_stds()</span></code></a>    processes standard star observations</li>
<li><a class="reference internal" href="#SEDMr.StartObs.proc_bias_crrs" title="SEDMr.StartObs.proc_bias_crrs"><code class="xref py py-func docutils literal"><span class="pre">proc_bias_crrs()</span></code></a>  processes biases and CR rejection</li>
<li><a class="reference internal" href="#SEDMr.StartObs.docp" title="SEDMr.StartObs.docp"><code class="xref py py-func docutils literal"><span class="pre">docp()</span></code></a>            low level copy routine that avoids test and focus images</li>
<li><a class="reference internal" href="#SEDMr.StartObs.cal_proc_ready" title="SEDMr.StartObs.cal_proc_ready"><code class="xref py py-func docutils literal"><span class="pre">cal_proc_ready()</span></code></a>  check if all required raw cal images are present</li>
<li><a class="reference internal" href="#SEDMr.StartObs.cal_ready" title="SEDMr.StartObs.cal_ready"><code class="xref py py-func docutils literal"><span class="pre">cal_ready()</span></code></a>       check if all required processed cal files are present</li>
<li><a class="reference internal" href="#SEDMr.StartObs.cal_reset" title="SEDMr.StartObs.cal_reset"><code class="xref py py-func docutils literal"><span class="pre">cal_reset()</span></code></a>       reset the status of calibration files</li>
</ul>
</dd>
<dt>Globals</dt>
<dd><ul class="first last simple">
<li>fileSize        - size in bytes of a complete fits file, currently 8400960</li>
<li>nbias,nbias2,nXe,ndome,nHg,nCd  - current count of raw cal files</li>
<li>CalProcReady    - are all required raw cal images present?</li>
<li>CalReady        - are all required processed cal files present?</li>
<li>CalPrevious     - are we using files from a previous night?</li>
<li>BiasReady       - are there enough biases to process?</li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This is used as a python script as follows:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">StartObs</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">rawdir</span> <span class="n">RAWDIR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">reduxdir</span> <span class="n">REDUXDIR</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>           <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">--</span><span class="n">rawdir</span> <span class="n">RAWDIR</span>      <span class="n">Input</span> <span class="n">raw</span> <span class="n">directory</span> <span class="p">(</span><span class="o">/</span><span class="n">scr2</span><span class="o">/</span><span class="n">sedm</span><span class="o">/</span><span class="n">raw</span><span class="p">)</span>
  <span class="o">--</span><span class="n">reduxdir</span> <span class="n">REDUXDIR</span>  <span class="n">Output</span> <span class="n">reduced</span> <span class="n">directory</span> <span class="p">(</span><span class="o">/</span><span class="n">scr2</span><span class="o">/</span><span class="n">sedm</span><span class="o">/</span><span class="n">redux</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="function">
<dt id="SEDMr.StartObs.ObsLoop">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">ObsLoop</code><span class="sig-paren">(</span><em>rawlist=None</em>, <em>redd=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#ObsLoop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.ObsLoop" title="Permalink to this definition">¶</a></dt>
<dd><p>One night observing loop: processes calibrations and science data</p>
<p>Copy raw cal files until we are ready to process the night&#8217;s
calibrations.  When ready, process them.  If we get to UT = 3:00,
the sun has set and we then retrieve the processed cal files from
the most recent night.  Next, enter a loop that waits for new ifu
images, copies them and performs the basic bias removal and CR
rejection processing.  If there are standard star observations,
re-generate the standard star calibration.  If we get no new ifu
files and we get to UT = 15:00, then the sun is up and we exit
the loop.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rawlist</strong> (<em>list</em>) &#8211; list of raw data directories (usually in /scr2/sedm/raw)</li>
<li><strong>redd</strong> (<em>str</em>) &#8211; reduced directory (something like /scr2/sedm/redux)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if night completed normally, False otherwise</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">KeyboardInterrupt handler exits gracefully with a ctrl-C.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.cal_proc_ready">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">cal_proc_ready</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#cal_proc_ready"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.cal_proc_ready" title="Permalink to this definition">¶</a></dt>
<dd><p>Check counts for all required raw cal file types in current directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sets CalProcReady global boolean</p>
</div>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.cal_ready">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">cal_ready</code><span class="sig-paren">(</span><em>reddir='./'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#cal_ready"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.cal_ready" title="Permalink to this definition">¶</a></dt>
<dd><p>Check for all required calibration files in input reduced directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>reddir</strong> (<em>str</em>) &#8211; directory to check</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sets BiasReady and/or CalReady global booleans</p>
</div>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.cal_reset">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">cal_reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#cal_reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.cal_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset counts of raw calibration files, and calibration status booleans.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Resets global counters and switches to 0 and/or False</p>
</div>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.cpcal">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">cpcal</code><span class="sig-paren">(</span><em>srcdir</em>, <em>destdir='./'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#cpcal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.cpcal" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy raw cal files from srcdir into destdir.</p>
<p>Find calibration files taken within 10 hours of the day changeover
and copy them to the destination directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>srcdir</strong> (<em>str</em>) &#8211; source for raw cal images, typically in /scr2/sedm/raw</li>
<li><strong>destdir</strong> (<em>str</em>) &#8211; place to put the cal images, typically in /scr2/sedm/redux</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">number of images actually copied</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.cpnew">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">cpnew</code><span class="sig-paren">(</span><em>srcdir</em>, <em>destdir='./'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#cpnew"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.cpnew" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies new files from srcdir to destdir.</p>
<p>Searches for most recent ifu image in destdir and looks for and
copies any ifu images in srcdir that are newer and complete.
Then bias subtracts and CR rejects the copied images.  If any are standard
star observations, process them as well.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>srcdir</strong> (<em>str</em>) &#8211; source directory (typically in /scr2/sedm/raw)</li>
<li><strong>destdir</strong> (<em>str</em>) &#8211; destination directory (typically in /scr2/sedm/redux)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Number of ifu images actually copied</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.cpprecal">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">cpprecal</code><span class="sig-paren">(</span><em>dirlist</em>, <em>destdir='./'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#cpprecal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.cpprecal" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy raw cal files from previous date&#8217;s directory</p>
<p>Make sure we only look in previous day directory for files created
within four hours of the day changeover for possible raw calibration
files required for the current night&#8217;s calibration.  Copy any such
files into the destination directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dirlist</strong> (<em>list</em>) &#8211; a list of raw directories (typically in /scr2/sedm/raw)</li>
<li><strong>destdir</strong> (<em>str</em>) &#8211; where to put the files</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">number of images actually copied</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.docp">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">docp</code><span class="sig-paren">(</span><em>src</em>, <em>dest</em>, <em>onsky=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#docp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.docp" title="Permalink to this definition">¶</a></dt>
<dd><p>Low level copy from raw directory to redux directory.</p>
<p>Checks for raw cal files, standard star observations and
increments their respective counters, while avoiding any
test and focus images. Uses shutil.copy2 to do the copying.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>src</strong> (<em>str</em>) &#8211; source file</li>
<li><strong>dest</strong> (<em>str</em>) &#8211; destination directory</li>
<li><strong>onsky</strong> (<em>bool</em>) &#8211; test for dome conditions or not</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>number of images copied, number of standard</dt>
<dd><p class="first last">star images copied</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">(int, int)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Increments global raw calibration file counters</p>
</div>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.find_recent">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">find_recent</code><span class="sig-paren">(</span><em>redd</em>, <em>fname</em>, <em>destdir</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#find_recent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.find_recent" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the most recent version of fname and copy it to destdir.</p>
<p>Look through sorted list of redux directories to find most recent
version of the input file.  Copy it to the destination directory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>redd</strong> (<em>str</em>) &#8211; reduced directory (something like /scr2/sedm/redux)</li>
<li><strong>fname</strong> (<em>str</em>) &#8211; what file to look for</li>
<li><strong>destdir</strong> (<em>str</em>) &#8211; where the file should go</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if file found and copied, False otherwise.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.go">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">go</code><span class="sig-paren">(</span><em>rawd='/scr2/sedm/raw'</em>, <em>redd='/scr2/sedm/redux'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#go"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.go" title="Permalink to this definition">¶</a></dt>
<dd><p>Outermost infinite loop that watches for a new raw directory.</p>
<p>Keep a list of raw directories in <cite>redd</cite> and fire off
the ObsLoop procedure when a new directory appears.  Check for
a new raw directory every 10 minutes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rawd</strong> (<em>str</em>) &#8211; raw directory, should be /scr2/sedm/raw</li>
<li><strong>redd</strong> (<em>str</em>) &#8211; reduced directory, should be like /scr2/sedm/redux</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">KeyboardInterrupt handler exits gracefully with a ctrl-C.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.proc_bias_crrs">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">proc_bias_crrs</code><span class="sig-paren">(</span><em>ncp=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#proc_bias_crrs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.proc_bias_crrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Process biases and CR rejection steps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ncp</strong> (<em>int</em>) &#8211; number of images copied into redux directory</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if processing was successful, otherwise False</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.StartObs.proc_stds">
<code class="descclassname">SEDMr.StartObs.</code><code class="descname">proc_stds</code><span class="sig-paren">(</span><em>ncp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/StartObs.html#proc_stds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.StartObs.proc_stds" title="Permalink to this definition">¶</a></dt>
<dd><p>Process standard star observations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ncp</strong> (<em>int</em>) &#8211; number of standard star images copied into redux directory</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if processing was successful, otherwise False</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.SubtractBackground">
<span id="sedmr-subtractbackground-module"></span><h2>3.26. SEDMr.SubtractBackground module<a class="headerlink" href="#module-SEDMr.SubtractBackground" title="Permalink to this headline">¶</a></h2>
<p>Subtract background from ifu images.</p>
<dl class="function">
<dt id="SEDMr.SubtractBackground.estimateBackground">
<code class="descclassname">SEDMr.SubtractBackground.</code><code class="descname">estimateBackground</code><span class="sig-paren">(</span><em>fine</em>, <em>infile</em>, <em>flex=None</em>, <em>gausswidth=100</em>, <em>outname=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SubtractBackground.html#estimateBackground"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SubtractBackground.estimateBackground" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.SubtractBackground.remove">
<code class="descclassname">SEDMr.SubtractBackground.</code><code class="descname">remove</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SubtractBackground.html#remove"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SubtractBackground.remove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.SubtractBackground.weaveConvolve">
<code class="descclassname">SEDMr.SubtractBackground.</code><code class="descname">weaveConvolve</code><span class="sig-paren">(</span><em>image</em>, <em>kernel</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/SubtractBackground.html#weaveConvolve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.SubtractBackground.weaveConvolve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-SEDMr.Wavelength">
<span id="sedmr-wavelength-module"></span><h2>3.27. SEDMr.Wavelength module<a class="headerlink" href="#module-SEDMr.Wavelength" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.Wavelength.RMS">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">RMS</code><span class="sig-paren">(</span><em>vec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#RMS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.RMS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.assign_fit_to_spectra">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">assign_fit_to_spectra</code><span class="sig-paren">(</span><em>target</em>, <em>gridded</em>, <em>rss</em>, <em>fix</em>, <em>stretch</em>, <em>lamfit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#assign_fit_to_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.assign_fit_to_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Put wavelength solution into target</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>target</strong> (<em>list of Extraciton</em>) &#8211; Target list of extractions</li>
<li><strong>gridded</strong> (<em>list of Extractions[Ne]</em>) &#8211; Gridded spectra</li>
<li><strong>rss</strong> (<em>list of float[Ne]</em>) &#8211; RSS wavelength fit error</li>
<li><strong>fix</strong> (<em>list of float</em>) &#8211; Fiducial spectral index  for &#8220;stretch&#8221;</li>
<li><strong>stretch</strong> (<em>list of float [Ne x Nfloat]</em>) &#8211; Float polynomials to stretch</li>
<li><strong>onto</strong> (<a class="reference internal" href="#SEDMr.GUI.PositionPicker.spectra" title="SEDMr.GUI.PositionPicker.spectra"><em>spectra</em></a>) &#8211; </li>
<li><strong>lamfit</strong> (<em>list of float [Ne x Ncoeff]</em>) &#8211; Wavelength fitting function</li>
<li><strong>coefficients</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">New grid with coefficients assigned to it</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.assoc_hg_with_flats">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">assoc_hg_with_flats</code><span class="sig-paren">(</span><em>domedat_par</em>, <em>hgcat_par</em>, <em>guess_offset_par={546.1: 133</em>, <em>578.0: 110</em>, <em>435.8: 193</em>, <em>365.0: 231</em>, <em>404.6: 214}</em>, <em>outname='assoc_Hg'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#assoc_hg_with_flats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.assoc_hg_with_flats" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of functions defining the ridgeline of dome flats
and a list of positions of mercury lamps, provide a crude wavelength
solution</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>guess_offset</strong> &#8211; Dictionary of {wavelength in nm: x position} indicating
the rough distance from the segment start to the wavelength</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.assoc_hg_with_flats_helper">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">assoc_hg_with_flats_helper</code><span class="sig-paren">(</span><em>idx</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#assoc_hg_with_flats_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.assoc_hg_with_flats_helper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.coeffs_to_spec">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">coeffs_to_spec</code><span class="sig-paren">(</span><em>fix</em>, <em>gridded</em>, <em>rgrd_coef</em>, <em>lam_coef</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#coeffs_to_spec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.coeffs_to_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the spectrum given the unadultered spectrum and fits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fix</strong> (<em>array</em>) &#8211; </li>
<li><strong>gridded</strong> (<a class="reference internal" href="#SEDMr.Extraction.Extraction" title="SEDMr.Extraction.Extraction"><em>Extraction</em></a>) &#8211; </li>
<li><strong>rgrd_coef</strong> (<em>list</em>) &#8211; the stretch of the spectrum to put onto the fiducial index
array (fix)</li>
<li><strong>lam_coeff</strong> (<em>list</em>) &#8211; fix to wavelength in nm</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Tuple containing the wavelength and spectrum
(wavelength, spectrum) this is in the units of the fit coefficients.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.extract">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">extract</code><span class="sig-paren">(</span><em>HDUlist</em>, <em>assoc_hg_spec</em>, <em>filename='raw_extractions'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.extract" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.extract_helper">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">extract_helper</code><span class="sig-paren">(</span><em>ss</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#extract_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.extract_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: MERGE WITH wavelength_extract_helper.
Functionallity is repeated.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fiducial_spectrum">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fiducial_spectrum</code><span class="sig-paren">(</span><em>lamstart=1050.0</em>, <em>lamratio=0.9958333333333333</em>, <em>len=265</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fiducial_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fiducial_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a typical SED Machine spectrum, use for interpolating on grid</p>
<dl class="docutils">
<dt>Reference:</dt>
<dd><p class="first">The equation for the fiducsial spectrum look like:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span>                <span class="n">x</span>
<span class="mi">1000</span> <span class="n">x</span> <span class="p">(</span><span class="mi">239</span><span class="o">/</span><span class="mi">240</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lamstart</strong> (<em>float</em>) &#8211; default is 1050 nm</li>
<li><strong>lamratio</strong> (<em>float</em>) &#8211; default is 239/240, good for SEDM</li>
<li><strong>len</strong> (<em>int</em>) &#8211; default of 265 yields a spectrum that goes to ~ 350 nm</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fiducial_wavelength">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fiducial_wavelength</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fiducial_wavelength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fiducial_wavelength" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.find_hg_spectra">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">find_hg_spectra</code><span class="sig-paren">(</span><em>lines</em>, <em>dYlimit=2</em>, <em>outname='find_spectra'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#find_hg_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.find_hg_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on line ratios and positions, determine positions of Hg lines</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lines</strong> &#8211; line list</li>
<li><strong>dYlimit</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Results:</dt>
<dd>Writes [return value] to outname in npy format</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">[(pixel coords) ...], ...}
Each wavelength has a list of pixel coords of different length.
The coordinates are diassociated from one and other.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Returns dictionary of {wavelength nm</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fit_all_lines">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fit_all_lines</code><span class="sig-paren">(</span><em>fiducial</em>, <em>hg_spec</em>, <em>xe_spec</em>, <em>xxs</em>, <em>cd_spec=None</em>, <em>he_spec=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fit_all_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fit_all_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit mercury + xenon lines to a set of spectra that are put on a common fiducial grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fiducial</strong> (<em>int[Nf]</em>) &#8211; Fiducial index values range from about -130 to + 130</li>
<li><strong>hg_spec</strong> (<em>Extraction[Ne]</em>) &#8211; Mercury spectra</li>
<li><strong>xe_spec</strong> (<em>Extraction[Ne]</em>) &#8211; Xenon spectra</li>
<li><strong>xxs</strong> (<em>Gridded[Ne]</em>) &#8211; Results from stretch_set() call</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fit_cd_lines">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fit_cd_lines</code><span class="sig-paren">(</span><em>SS</em>, <em>guesses={508.5: 18</em>, <em>479.9: 33</em>, <em>467.8: 41}</em>, <em>plot=False</em>, <em>Ncutout=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fit_cd_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fit_cd_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fit_he_lines">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fit_he_lines</code><span class="sig-paren">(</span><em>SS</em>, <em>guesses={587.5: -18</em>, <em>667.8: -48</em>, <em>706.5: -60}</em>, <em>plot=False</em>, <em>Ncutout=7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fit_he_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fit_he_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fit_hg_lines">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fit_hg_lines</code><span class="sig-paren">(</span><em>SS</em>, <em>guesses={435.8: 60</em>, <em>578: -14</em>, <em>546.1: 0</em>, <em>404.6: 81}</em>, <em>plot=False</em>, <em>Ncutout=7</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fit_hg_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fit_hg_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fit_known_lines">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fit_known_lines</code><span class="sig-paren">(</span><em>SS</em>, <em>guesses</em>, <em>plot</em>, <em>Ncutout</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fit_known_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fit_known_lines" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit line positions based on guess pixel positions against a fiducial spectrum</p>
<p>This function is mapable</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>is a list of two elements containting</strong> (<em>SS</em>) &#8211; spix(int[Ns]): Index values (pixel) of spec
spec(float[Ns]): Flux from corresponding index values</li>
<li><strong>guesses</strong> &#8211; Dictionary containing {wavelength in nm: pixel guess position}</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><dl class="docutils">
<dt>[ (wavelength in nm, centroid position in pixel) ] with length</dt>
<dd><p class="first last">len(guesses.keys()).</p>
</dd>
</dl>
<p>Intent is for this list to be fit with polynomials to construct the
wavelength solution.</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fit_spectra_Hg_Xe">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fit_spectra_Hg_Xe</code><span class="sig-paren">(</span><em>Hgs</em>, <em>Xes</em>, <em>kdtree</em>, <em>kdseg_ids</em>, <em>plot=False</em>, <em>outname='fit_spectra'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fit_spectra_Hg_Xe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fit_spectra_Hg_Xe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fit_xe_lines">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fit_xe_lines</code><span class="sig-paren">(</span><em>SS</em>, <em>guesses={828: -93</em>, <em>764: -77}</em>, <em>plot=False</em>, <em>Ncutout=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fit_xe_lines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fit_xe_lines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.fractional_sum">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">fractional_sum</code><span class="sig-paren">(</span><em>FS_Y</em>, <em>FS_EW</em>, <em>FS_dat</em>, <em>FS_Yx1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#fractional_sum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.fractional_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns sum of FS_dat via a partial-pixel method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>FS_Y</strong> (<em>float</em>) &#8211; location of trace in vertical direciton</li>
<li><strong>FS_EW</strong> (<em>float</em>) &#8211; Width of trace around FS_Y</li>
<li><strong>FS_dat</strong> (<em>float vector</em>) &#8211; Data to sum</li>
<li><strong>FS_Yx1</strong> (<em>float</em>) &#8211; Start location of data</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><dl class="docutils">
<dt>Float containing the sum of data in FS_Y while taking partial</dt>
<dd><p class="first last">pixels into account.</p>
</dd>
</dl>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-exc docutils literal"><span class="pre">Nothing.</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.get_stretched">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">get_stretched</code><span class="sig-paren">(</span><em>fid_ix</em>, <em>coeffs</em>, <em>spec1</em>, <em>spec2=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#get_stretched"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.get_stretched" title="Permalink to this definition">¶</a></dt>
<dd><p>Reinterpolate spec1 and spec2 onto the fiducial index set by stretching and scaling the spectra</p>
<dl class="docutils">
<dt>This is used after a call that looks something like:</dt>
<dd><p class="first">ll = np.load(&#8220;Hg_ext.npy&#8221;)
lx = np.load(&#8220;Xe_ext.npy&#8221;)
gg = rough_grid(ll)
coeffs, fix = stretch_set(gg, lx)</p>
<p class="last">s1, s2 = get_stretched(fix, coeffs[5], ll[5], lx[5])</p>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><strong>s1, s2 [float</strong> &#8211; Spectra</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">len(fid_ix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.hg_to_kdtree">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">hg_to_kdtree</code><span class="sig-paren">(</span><em>assoc_hg_spec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#hg_to_kdtree"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.hg_to_kdtree" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert mercury association to a KD Tree</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.make_profile">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">make_profile</code><span class="sig-paren">(</span><em>slice</em>, <em>sigma2=4</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#make_profile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.make_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a gaussian profile with the same dimensions as the slice</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.measure_offsets">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">measure_offsets</code><span class="sig-paren">(</span><em>spec</em>, <em>coeff</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#measure_offsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.measure_offsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Measure wavelength offsets of Hg and Xe extractions</p>
<p>First uses a crude peak finding code to identify the locations of the
Xe lines.</p>
<p>Then, the two Xe complexes are fit individually</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">offset_nm}.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A dictionary of {line_wavelength_nm</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.median_fine_grid">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">median_fine_grid</code><span class="sig-paren">(</span><em>fine</em>, <em>doPlot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#median_fine_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.median_fine_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the 7 nearest neighbors, median the wavelength solution. Refit the wavelength solution to this median wavelength.</p>
<dl class="docutils">
<dt>Input:</dt>
<dd>fine: Dictionary that contains the fine wavelength solution</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">fine.mdn_coeff contains updated chebyshev polynomial coefficients</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.median_rough_grid">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">median_rough_grid</code><span class="sig-paren">(</span><em>gridded</em>, <em>Hg_E</em>, <em>outname='median_rough_wavelength.npy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#median_rough_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.median_rough_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Using the 7 nearest neighbors, median the wavelength solution coefficients</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.peakdet">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">peakdet</code><span class="sig-paren">(</span><em>v</em>, <em>delta</em>, <em>x=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#peakdet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.peakdet" title="Permalink to this definition">¶</a></dt>
<dd><p>Converted from MATLAB script at <a class="reference external" href="http://billauer.co.il/peakdet.html">http://billauer.co.il/peakdet.html</a></p>
<p>Returns two arrays</p>
<p>function [maxtab, mintab]=peakdet(v, delta, x)
%PEAKDET Detect peaks in a vector
%        [MAXTAB, MINTAB] = PEAKDET(V, DELTA) finds the local
%        maxima and minima (&#8220;peaks&#8221;) in the vector V.
%        MAXTAB and MINTAB consists of two columns. Column 1
%        contains indices in V, and column 2 the found values.
%
%        With [MAXTAB, MINTAB] = PEAKDET(V, DELTA, X) the indices
%        in MAXTAB and MINTAB are replaced with the corresponding
%        X-values.
%
%        A point is considered a maximum peak if it has the maximal
%        value, and was preceded (to the left) by a value lower by
%        DELTA.</p>
<p>% Eli Billauer, 3.4.05 (Explicitly not copyrighted).
% This function is released to the public domain; Any use is allowed.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.plot_grid">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">plot_grid</code><span class="sig-paren">(</span><em>grid</em>, <em>Xes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#plot_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.plot_grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.read_catalog">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">read_catalog</code><span class="sig-paren">(</span><em>catname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#read_catalog"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.read_catalog" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a sextractor catalog called catname and return</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.read_spec_loc">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">read_spec_loc</code><span class="sig-paren">(</span><em>spec_loc_fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#read_spec_loc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.read_spec_loc" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the structure for the location of each spectrum</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.rough_grid">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">rough_grid</code><span class="sig-paren">(</span><em>data, the_lines=[365.0, 404.6, 435.8, 546.1, 578], outname='rough_wavelength.npy'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#rough_grid"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.rough_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift the extractions onto a coarse common pixel grid</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.rough_grid_helper">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">rough_grid_helper</code><span class="sig-paren">(</span><em>ix</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#rough_grid_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.rough_grid_helper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.save_fitted_ds9">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">save_fitted_ds9</code><span class="sig-paren">(</span><em>fitted</em>, <em>outname='fine'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#save_fitted_ds9"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.save_fitted_ds9" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.scale_on_547">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">scale_on_547</code><span class="sig-paren">(</span><em>spec</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#scale_on_547"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.scale_on_547" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.snap_solution_into_place">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">snap_solution_into_place</code><span class="sig-paren">(</span><em>PARS</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#snap_solution_into_place"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.snap_solution_into_place" title="Permalink to this definition">¶</a></dt>
<dd><p>Return new Chebyshev coefficients for best fit wavelength solution</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.snap_solution_into_place_all">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">snap_solution_into_place_all</code><span class="sig-paren">(</span><em>fine</em>, <em>Hgs</em>, <em>Xes</em>, <em>Cds=None</em>, <em>Hes=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#snap_solution_into_place_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.snap_solution_into_place_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a global solution for dispersion function using Hg, Xe, possibly Cd data</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.stretch_fit_helper">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">stretch_fit_helper</code><span class="sig-paren">(</span><em>specno</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#stretch_fit_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.stretch_fit_helper" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper for Multiprocessing Pool</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.stretch_set">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">stretch_set</code><span class="sig-paren">(</span><em>Hg_set</em>, <em>Xe_set</em>, <em>mscales=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#stretch_set"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.stretch_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift and stretch spectra so they have the same pixel index</p>
<p>Steps:
1. Shift spectra without interpolation onto a common pixel grid with index 0 being a prominent Hg line.
2. Create a set of interpolating functions for each of the spectra in the set. These functions are called as flux(pixel).
3. Brute force search for the best stretch and 2nd-order polynomial coefficient for each spectrum in the set, compared to the fiducial spectrum.
4. Brute force will measure the above for the xenon and mercury spectra indepdentnly.
5. Then we stitch together a master pixel shift based on a chebyshev fit of the xenon and mercury spectra. The chebyshev fit creates a function such that f(pixel) &#8211;&gt; pixel. On this new grid, all spectra are close to the same.</p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.wavelength_extract">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">wavelength_extract</code><span class="sig-paren">(</span><em>HDUlist_par</em>, <em>wavecalib_par</em>, <em>filename='extracted_spectra.npy'</em>, <em>flexure_x_corr_nm=0.0</em>, <em>flexure_y_corr_pix=0.0</em>, <em>extract_width_par=3</em>, <em>inname='unknown'</em>, <em>airmass=None</em>, <em>flat_corrections=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#wavelength_extract"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.wavelength_extract" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.wavelength_extract_helper">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">wavelength_extract_helper</code><span class="sig-paren">(</span><em>SS</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#wavelength_extract_helper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.wavelength_extract_helper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.xe_830nm">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">xe_830nm</code><span class="sig-paren">(</span><em>p</em>, <em>lam</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#xe_830nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.xe_830nm" title="Permalink to this definition">¶</a></dt>
<dd><p>Xe complex near 830 nm.</p>
<p>See: <a class="reference external" href="http://www2.keck.hawaii.edu/inst/lris/arc_calibrations.html">http://www2.keck.hawaii.edu/inst/lris/arc_calibrations.html</a></p>
</dd></dl>

<dl class="function">
<dt id="SEDMr.Wavelength.xe_890nm">
<code class="descclassname">SEDMr.Wavelength.</code><code class="descname">xe_890nm</code><span class="sig-paren">(</span><em>p</em>, <em>lam</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/Wavelength.html#xe_890nm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.Wavelength.xe_890nm" title="Permalink to this definition">¶</a></dt>
<dd><p>Xe complex near 890 nm.</p>
<p>See: <a class="reference external" href="http://www2.keck.hawaii.edu/inst/lris/arc_calibrations.html">http://www2.keck.hawaii.edu/inst/lris/arc_calibrations.html</a></p>
</dd></dl>

</div>
<div class="section" id="module-SEDMr.What">
<span id="sedmr-what-module"></span><h2>3.28. SEDMr.What module<a class="headerlink" href="#module-SEDMr.What" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="SEDMr.What.go">
<code class="descclassname">SEDMr.What.</code><code class="descname">go</code><span class="sig-paren">(</span><em>imfiles</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/SEDMr/What.html#go"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#SEDMr.What.go" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. SEDMr package</a><ul>
<li><a class="reference internal" href="#module-SEDMr.AtmCorr">3.1. SEDMr.AtmCorr module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Check">3.2. SEDMr.Check module</a></li>
<li><a class="reference internal" href="#module-SEDMr.CosmicX">3.3. SEDMr.CosmicX module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Cube">3.4. SEDMr.Cube module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Debias">3.5. SEDMr.Debias module</a></li>
<li><a class="reference internal" href="#module-SEDMr.DivideFlat">3.6. SEDMr.DivideFlat module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Extraction">3.7. SEDMr.Extraction module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Extractor">3.8. SEDMr.Extractor module</a></li>
<li><a class="reference internal" href="#module-SEDMr.FindSpectra">3.9. SEDMr.FindSpectra module</a></li>
<li><a class="reference internal" href="#module-SEDMr.FitsCube">3.10. SEDMr.FitsCube module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Flat">3.11. SEDMr.Flat module</a></li>
<li><a class="reference internal" href="#module-SEDMr.FlatCorrection">3.12. SEDMr.FlatCorrection module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Flexure">3.13. SEDMr.Flexure module</a></li>
<li><a class="reference internal" href="#module-SEDMr.GUI">3.14. SEDMr.GUI module</a></li>
<li><a class="reference internal" href="#module-SEDMr.IO">3.15. SEDMr.IO module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Imcombine">3.16. SEDMr.Imcombine module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Plan">3.17. SEDMr.Plan module</a></li>
<li><a class="reference internal" href="#module-SEDMr.RemoveBackground">3.18. SEDMr.RemoveBackground module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Roller">3.19. SEDMr.Roller module</a></li>
<li><a class="reference internal" href="#module-SEDMr.SexLamps">3.20. SEDMr.SexLamps module</a></li>
<li><a class="reference internal" href="#module-SEDMr.SexSpectra">3.21. SEDMr.SexSpectra module</a></li>
<li><a class="reference internal" href="#module-SEDMr.SpecArith">3.22. SEDMr.SpecArith module</a></li>
<li><a class="reference internal" href="#module-SEDMr.SpecNorm">3.23. SEDMr.SpecNorm module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Spectra">3.24. SEDMr.Spectra module</a></li>
<li><a class="reference internal" href="#module-SEDMr.StartObs">3.25. SEDMr.StartObs module</a></li>
<li><a class="reference internal" href="#module-SEDMr.SubtractBackground">3.26. SEDMr.SubtractBackground module</a></li>
<li><a class="reference internal" href="#module-SEDMr.Wavelength">3.27. SEDMr.Wavelength module</a></li>
<li><a class="reference internal" href="#module-SEDMr.What">3.28. SEDMr.What module</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="SEDM.html" title="previous chapter">2. SEDM package</a></li>
      <li>Next: <a href="SEDMrph.html" title="next chapter">4. SEDMrph package</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/SEDMr.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Nick Konidaris, Don Neill, Nadia Blagorodnova.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/SEDMr.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>